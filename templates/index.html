<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>True News - –ü—Ä–∞–≤–¥–∏–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞</title>
    <style>
        :root {
            /* Light theme colors */
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --success-color: #10b981;
            --danger-color: #ef4444;
            --warning-color: #f59e0b;
            --light-bg: #f8fafc;
            --white: #ffffff;
            --dark-text: #1e293b;
            --light-text: #64748b;
            --border-color: #e2e8f0;
            
            /* Dark theme colors */
            --dark-bg: #000000;
            --dark-surface: #1a0000;
            --dark-red: #dc2626;
            --dark-red-light: #ef4444;
            --dark-text-primary: #ffffff;
            --dark-text-secondary: #dc2626;
            --dark-border: #450000;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-text);
            background: var(--light-bg);
            transition: all 0.3s ease;
        }

        /* Light theme styles */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        header {
            background: var(--white);
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            text-decoration: none;
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-menu a {
            color: var(--dark-text);
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s ease;
        }

        .nav-menu a:hover {
            color: var(--primary-color);
        }

        .auth-buttons {
            display: flex;
            gap: 1rem;
        }

        .btn {
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: var(--primary-color);
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-secondary {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-secondary:hover {
            background: var(--primary-color);
            color: white;
        }

        .hero {
            background: linear-gradient(135deg, var(--primary-color), #1e40af);
            color: white;
            padding: 4rem 0;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .hero p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-content {
            padding: 3rem 0;
        }

        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .news-card {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            transition: transform 0.3s ease;
        }

        .news-card:hover {
            transform: translateY(-5px);
        }

        .news-card img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .news-content {
            padding: 1.5rem;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: var(--light-text);
        }

        .news-category {
            background: var(--primary-color);
            color: white;
            padding: 0.2rem 0.5rem;
            border-radius: 3px;
            font-size: 0.8rem;
        }

        .news-card h3 {
            margin-bottom: 1rem;
            color: var(--dark-text);
        }

        .news-preview {
            color: var(--light-text);
            margin-bottom: 1rem;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: var(--white);
            margin: 50px auto;
            padding: 2rem;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            position: relative;
            animation: slideIn 0.3s ease;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 2rem;
            cursor: pointer;
            color: var(--light-text);
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
        }

        /* Dark Web Styles */
        .dark-theme {
            background: var(--dark-bg);
            color: var(--dark-text-primary);
            min-height: 100vh;
        }

        .dark-verification {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--dark-bg);
            color: var(--dark-text-primary);
        }

        .verification-box {
            background: var(--dark-surface);
            padding: 3rem;
            border-radius: 10px;
            border: 2px solid var(--dark-red);
            text-align: center;
            box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
        }

        .verification-box h2 {
            color: var(--dark-red);
            margin-bottom: 2rem;
            font-size: 1.5rem;
        }

        .code-input {
            background: var(--dark-bg);
            color: var(--dark-text-primary);
            border: 1px solid var(--dark-red);
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 0.5rem;
        }

        .btn-dark {
            background: var(--dark-red);
            color: white;
            border: none;
            padding: 0.75rem 2rem;
            margin: 1rem 0;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .btn-dark:hover {
            background: var(--dark-red-light);
        }

        .dark-market {
            background: var(--dark-bg);
            color: var(--dark-text-primary);
            min-height: 100vh;
        }

        .dark-header {
            background: var(--dark-surface);
            border-bottom: 2px solid var(--dark-red);
            padding: 1rem 0;
        }

        .dark-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .dark-logo {
            color: var(--dark-red);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .dark-user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .balance {
            color: var(--dark-red);
            font-weight: bold;
        }

        .market-content {
            padding: 2rem;
        }

        .market-tabs {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            border-bottom: 1px solid var(--dark-border);
        }

        .tab {
            padding: 1rem 2rem;
            background: transparent;
            color: var(--dark-text-primary);
            border: none;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .tab.active {
            color: var(--dark-red);
            border-bottom-color: var(--dark-red);
        }

        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }

        .item-card {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 10px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .item-card:hover {
            border-color: var(--dark-red);
            box-shadow: 0 0 20px rgba(220, 38, 38, 0.2);
        }

        .item-name {
            color: var(--dark-red);
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .item-price {
            color: var(--dark-text-primary);
            font-size: 1.5rem;
            font-weight: bold;
            margin: 1rem 0;
        }

        .seller-info {
            display: flex;
            justify-content: space-between;
            margin: 1rem 0;
            font-size: 0.9rem;
            color: var(--light-text);
        }

        .rating {
            color: var(--warning-color);
        }

        /* Gang System */
        .gangs-section {
            margin-top: 3rem;
        }

        .gang-card {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
        }

        .gang-name {
            color: var(--dark-red);
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 1rem;
        }

        .gang-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            color: var(--dark-red);
            font-size: 1.5rem;
            font-weight: bold;
        }

        .stat-label {
            color: var(--light-text);
            font-size: 0.9rem;
        }

        /* Chat */
        .chat-container {
            background: var(--dark-surface);
            border: 1px solid var(--dark-border);
            border-radius: 10px;
            height: 400px;
            display: flex;
            flex-direction: column;
        }

        .chat-messages {
            flex: 1;
            padding: 1rem;
            overflow-y: auto;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.5rem;
            background: var(--dark-bg);
            border-radius: 5px;
        }

        .message-author {
            color: var(--dark-red);
            font-weight: bold;
            font-size: 0.9rem;
        }

        .message-text {
            margin-top: 0.25rem;
        }

        .chat-input {
            display: flex;
            padding: 1rem;
            border-top: 1px solid var(--dark-border);
        }

        .chat-input input {
            flex: 1;
            background: var(--dark-bg);
            color: var(--dark-text-primary);
            border: 1px solid var(--dark-border);
            padding: 0.5rem;
            border-radius: 5px;
            margin-right: 1rem;
        }

        /* Freeze effect */
        .freeze {
            pointer-events: none;
            opacity: 0.7;
            filter: blur(1px);
        }

        /* Glitch effect */
        .glitch {
            animation: glitch 0.3s ease-in-out;
        }

        @keyframes glitch {
            0% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
            100% { transform: translate(0); }
        }

        /* Matrix Effect */
        .matrix-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark-bg);
            z-index: -1;
            overflow: hidden;
        }

        .matrix-column {
            position: absolute;
            top: -100px;
            font-family: monospace;
            font-size: 12px;
            color: var(--dark-red);
            opacity: 0.8;
            animation: matrixFall linear infinite;
        }

        @keyframes matrixFall {
            0% { transform: translateY(-100px); }
            100% { transform: translateY(100vh); }
        }

        /* Loading Animation */
        .loading-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: var(--dark-bg);
            color: var(--dark-text-primary);
        }

        .loading-text {
            font-size: 1.5rem;
            color: var(--dark-red);
            margin-bottom: 2rem;
            animation: pulse 1s ease-in-out infinite;
        }

        .progress-bar {
            width: 300px;
            height: 20px;
            background: var(--dark-surface);
            border: 2px solid var(--dark-red);
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 2rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--dark-red), var(--dark-red-light));
            width: 0%;
            transition: width 0.3s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Admin Panel */
        .admin-panel {
            background: var(--dark-surface);
            border: 2px solid var(--dark-red);
            border-radius: 10px;
            padding: 2rem;
            margin: 2rem 0;
            box-shadow: 0 0 30px rgba(220, 38, 38, 0.3);
        }

        .admin-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 2rem 0;
        }

        .admin-stat-card {
            background: var(--dark-bg);
            border: 1px solid var(--dark-red);
            border-radius: 8px;
            padding: 1.5rem;
            text-align: center;
        }

        .admin-stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--dark-red);
        }

        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 2rem;
        }

        .admin-section {
            background: var(--dark-bg);
            border: 1px solid var(--dark-border);
            border-radius: 8px;
            padding: 1.5rem;
        }

        .delete-btn {
            background: var(--danger-color-dark, #dc2626);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .delete-btn:hover {
            background: var(--dark-red-light);
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .hidden {
            display: none !important;
        }

        /* Correspondent Panel */
        .correspondent-panel {
            background: var(--white);
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin: 2rem 0;
        }

        .correspondent-panel h3 {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
        }

        .form-group textarea {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            min-height: 120px;
            resize: vertical;
        }

        /* Services section */
        .services-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin: 2rem 0;
        }

        .service-card {
            background: var(--white);
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            padding: 2rem;
            text-align: center;
        }

        .service-price {
            color: var(--primary-color);
            font-size: 1.5rem;
            font-weight: bold;
            margin: 1rem 0;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .nav-menu {
                display: none;
            }
            
            .hero h1 {
                font-size: 2rem;
            }
            
            .news-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                margin: 20px;
                width: calc(100% - 40px);
            }
        }
    </style>
</head>
<body>
    <!-- Main Site -->
    <div id="mainSite">
        <header>
            <div class="container">
                <div class="header-content">
                    <a href="#" class="logo">True News</a>
                    <nav>
                        <ul class="nav-menu">
                            <li><a href="#" onclick="showSection('home')">üè† –ì–ª–∞–≤–Ω–∞—è</a></li>
                            <li><a href="#" onclick="showSection('about')">‚ÑπÔ∏è –û –Ω–∞—Å</a></li>
                            <li><a href="#" onclick="showSection('services')">‚öñÔ∏è –£—Å–ª—É–≥–∏ –∞–¥–≤–æ–∫–∞—Ç–∞</a></li>
                        </ul>
                    </nav>
                    <div class="auth-buttons">
                        <div id="authButtons">
                            <a href="#" class="btn btn-secondary" onclick="showLogin()">–í—Ö–æ–¥</a>
                            <a href="#" class="btn btn-primary" onclick="showRegister()">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</a>
                        </div>
                        <div id="userInfo" class="hidden">
                            <span id="userName"></span>
                            <a href="#" class="btn btn-secondary" onclick="logout()">–í—ã—Ö–æ–¥</a>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Home Section -->
        <section id="homeSection">
            <div class="hero">
                <div class="container">
                    <h1>True News</h1>
                    <p>–ü—Ä–∞–≤–¥–∏–≤—ã–µ –Ω–æ–≤–æ—Å—Ç–∏ –≤–∞—à–µ–≥–æ –≥–æ—Ä–æ–¥–∞</p>
                </div>
            </div>

            <main class="main-content">
                <div class="container">
                    <div id="correspondentPanel" class="correspondent-panel hidden">
                        <h3>üìù –ü–∞–Ω–µ–ª—å –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞</h3>
                        <div class="form-group">
                            <label>–ó–∞–≥–æ–ª–æ–≤–æ–∫ –Ω–æ–≤–æ—Å—Ç–∏:</label>
                            <input type="text" id="newsTitle" placeholder="–í–≤–µ–¥–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–æ–∫">
                        </div>
                        <div class="form-group">
                            <label>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</label>
                            <select id="newsCategory">
                                <option value="–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è">–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è</option>
                                <option value="–ü–æ–ª–∏—Ç–∏–∫–∞">–ü–æ–ª–∏—Ç–∏–∫–∞</option>
                                <option value="–≠–∫–æ–Ω–æ–º–∏–∫–∞">–≠–∫–æ–Ω–æ–º–∏–∫–∞</option>
                                <option value="–°–ø–æ—Ä—Ç">–°–ø–æ—Ä—Ç</option>
                                <option value="–ö—É–ª—å—Ç—É—Ä–∞">–ö—É–ª—å—Ç—É—Ä–∞</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ:</label>
                            <textarea id="newsPreview" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏"></textarea>
                        </div>
                        <div class="form-group">
                            <label>–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç:</label>
                            <textarea id="newsContent" placeholder="–ü–æ–ª–Ω—ã–π —Ç–µ–∫—Å—Ç –Ω–æ–≤–æ—Å—Ç–∏"></textarea>
                        </div>
                        <button class="btn btn-primary" onclick="publishNews()">üì∞ –û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç—å</button>
                    </div>

                    <h2>üî• –ü–æ—Å–ª–µ–¥–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏</h2>
                    
                    <!-- News Filters -->
                    <div style="background: white; padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center;">
                            <input type="text" id="newsSearch" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É..." style="flex: 1; min-width: 200px; padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 5px;" oninput="filterNews()">
                            <select id="categoryFilter" style="padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 5px;" onchange="filterNews()">
                                <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                                <option value="–ü–æ–ª–∏—Ç–∏–∫–∞">–ü–æ–ª–∏—Ç–∏–∫–∞</option>
                                <option value="–≠–∫–æ–Ω–æ–º–∏–∫–∞">–≠–∫–æ–Ω–æ–º–∏–∫–∞</option>
                                <option value="–°–ø–æ—Ä—Ç">–°–ø–æ—Ä—Ç</option>
                                <option value="–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è">–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è</option>
                                <option value="–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                            </select>
                            <select id="sortOrder" style="padding: 0.5rem; border: 1px solid var(--border-color); border-radius: 5px;" onchange="filterNews()">
                                <option value="new">–ù–æ–≤—ã–µ</option>
                                <option value="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</option>
                                <option value="views">–ü–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞–º</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="news-grid" id="newsGrid">
                        <!-- News will be dynamically loaded here -->
                    </div>
                </div>
            </main>
        </section>

        <!-- About Section -->
        <section id="aboutSection" class="hidden">
            <div class="container" style="padding: 3rem 0;">
                <h2>–û –Ω–∞—Å</h2>
                <div style="background: white; padding: 2rem; border-radius: 10px; margin: 2rem 0;">
                    <p>True News - —ç—Ç–æ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –Ω–æ–≤–æ—Å—Ç–Ω–æ–π –ø–æ—Ä—Ç–∞–ª, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç—Ä–µ–º–∏—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—É—é –∏ –∞–∫—Ç—É–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. –ú—ã —Ä–∞–±–æ—Ç–∞–µ–º 24/7, —á—Ç–æ–±—ã –¥–µ—Ä–∂–∞—Ç—å –≤–∞—Å –≤ –∫—É—Ä—Å–µ –≤—Å–µ—Ö –≤–∞–∂–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.</p>
                    <br>
                    <p>–ù–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –æ–ø—ã—Ç–Ω—ã—Ö –∂—É—Ä–Ω–∞–ª–∏—Å—Ç–æ–≤ –∏ –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ç—â–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–∞–∂–¥—É—é –Ω–æ–≤–æ—Å—Ç—å –ø–µ—Ä–µ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π.</p>
                    <br>
                    <p>–ö—Ä–æ–º–µ –Ω–æ–≤–æ—Å—Ç–µ–π, –º—ã —Ç–∞–∫–∂–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º —é—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏ —á–µ—Ä–µ–∑ –Ω–∞—à—É –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫—É—é —Å–µ—Ç—å –∫–≤–∞–ª–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∞–¥–≤–æ–∫–∞—Ç–æ–≤.</p>
                </div>
            </div>
        </section>

        <!-- Services Section -->
        <section id="servicesSection" class="hidden">
            <div class="container" style="padding: 3rem 0;">
                <h2>‚öñÔ∏è –£—Å–ª—É–≥–∏ –∞–¥–≤–æ–∫–∞—Ç–∞</h2>
                <div class="services-grid" id="servicesGrid">
                    <!-- Services will be dynamically loaded here -->
                </div>
            </div>
        </section>
    </div>

    <!-- Dark Web Loading -->
    <div id="darkLoading" class="loading-screen hidden">
        <div class="matrix-bg" id="matrixBg"></div>
        <div class="loading-text" id="loadingText">CONNECTING TO DARK NET...</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div style="color: #666; font-size: 0.9rem;">‚ö†Ô∏è –≠—Ç–æ —Ä–æ–ª–µ–≤–∞—è –∏–≥—Ä–∞</div>
    </div>

    <!-- Dark Web Verification Step 1 -->
    <div id="darkVerification1" class="dark-verification hidden">
        <div class="verification-box">
            <h2>üîí –°–ò–°–¢–ï–ú–ê –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò - –®–ê–ì 1/3</h2>
            <p>–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞:</p>
            <input type="text" class="code-input" id="verificationCode" placeholder="_ _ _ _" maxlength="3">
            <br>
            <button class="btn-dark" onclick="verifyStep1()">–ü–û–î–¢–í–ï–†–î–ò–¢–¨</button>
            <p style="color: #666; margin-top: 1rem; font-size: 0.9rem;">‚ö†Ô∏è –≠—Ç–æ —Ä–æ–ª–µ–≤–∞—è –∏–≥—Ä–∞, –Ω–µ –∏–º–µ—é—â–∞—è –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∫ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏</p>
        </div>
    </div>

    <!-- Dark Web Verification Step 2 -->
    <div id="darkVerification2" class="dark-verification hidden">
        <div class="verification-box">
            <h2>üîó –°–ò–°–¢–ï–ú–ê –í–ï–†–ò–§–ò–ö–ê–¶–ò–ò - –®–ê–ì 2/3</h2>
            <p>–í–≤–µ–¥–∏—Ç–µ –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—É—é —Å—Å—ã–ª–∫—É –æ—Ç –∑–Ω–∞–∫–æ–º–æ–≥–æ:</p>
            <input type="text" class="code-input" id="inviteLink" placeholder="https://invite.to/..." style="font-size: 0.9rem; letter-spacing: normal;">
            <br>
            <button class="btn-dark" onclick="verifyStep2()">–ü–†–û–í–ï–†–ò–¢–¨ –°–°–´–õ–ö–£</button>
        </div>
    </div>

    <!-- Dark Web Verification Step 3 -->
    <div id="darkVerification3" class="dark-verification hidden">
        <div class="verification-box">
            <h2>üë§ –í–•–û–î –ù–ê –ü–õ–û–©–ê–î–ö–£ - –®–ê–ì 3/3</h2>
            <div class="form-group">
                <label style="color: var(--dark-red);">–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="darkUsername" class="code-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω" style="letter-spacing: normal;">
            </div>
            <div class="form-group">
                <label style="color: var(--dark-red);">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="darkPassword" class="code-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="letter-spacing: normal;">
            </div>
            <button class="btn-dark" onclick="verifyStep3()">–í–û–ô–¢–ò</button>
            <button class="btn-dark" onclick="showDarkRegister()" style="background: var(--dark-surface); margin-left: 1rem;">–†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø</button>
        </div>
    </div>

    <!-- Dark Market -->
    <div id="darkMarket" class="dark-market hidden">
        <header class="dark-header">
            <div class="container">
                <div class="dark-nav">
                    <div class="dark-logo">üï∑Ô∏è DARK MARKET</div>
                    <div class="dark-user-info">
                        <span class="balance">üí∞ <span id="userBalance">50000</span> ‚ÇΩ</span>
                        <button class="btn-dark" onclick="exitDarkMarket()">–í–´–•–û–î</button>
                    </div>
                </div>
            </div>
        </header>

        <div class="container market-content">
            <!-- Market Search & Filter -->
            <div style="background: var(--dark-surface); padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                    <input type="text" id="marketSearch" placeholder="üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤..." style="flex: 1; min-width: 200px; padding: 0.5rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" oninput="filterMarketItems()">
                    <select id="marketCategory" style="padding: 0.5rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" onchange="filterMarketItems()">
                        <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
                        <option value="–û—Ä—É–∂–∏–µ">–û—Ä—É–∂–∏–µ</option>
                        <option value="–î–æ–∫—É–º–µ–Ω—Ç—ã">–î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                        <option value="–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞">–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞</option>
                        <option value="–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞">–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞</option>
                        <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                    </select>
                    <input type="number" id="priceMin" placeholder="–ú–∏–Ω. —Ü–µ–Ω–∞" style="width: 120px; padding: 0.5rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" oninput="filterMarketItems()">
                    <input type="number" id="priceMax" placeholder="–ú–∞–∫—Å. —Ü–µ–Ω–∞" style="width: 120px; padding: 0.5rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" oninput="filterMarketItems()">
                    <select id="marketSort" style="padding: 0.5rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" onchange="filterMarketItems()">
                        <option value="new">–ù–æ–≤—ã–µ</option>
                        <option value="cheap">–î–µ—à–µ–≤—ã–µ</option>
                        <option value="expensive">–î–æ—Ä–æ–≥–∏–µ</option>
                        <option value="popular">–ü–æ–ø—É–ª—è—Ä–Ω—ã–µ</option>
                    </select>
                </div>
            </div>
            
            <div class="market-tabs">
                <button class="tab active" onclick="showMarketTab('items')">üõí –ú–ê–ì–ê–ó–ò–ù</button>
                <button class="tab" onclick="showMarketTab('gangs')">üë• –ì–†–£–ü–ü–ò–†–û–í–ö–ò</button>
                <button class="tab" onclick="showMarketTab('chat')">üí¨ –ß–ê–¢</button>
                <button class="tab" onclick="showMarketTab('myItems')">üì¶ –ú–û–ò –¢–û–í–ê–†–´</button>
                <button class="tab" onclick="showMarketTab('profile')">üë§ –ü–†–û–§–ò–õ–¨</button>
                <button class="tab" onclick="showMarketTab('escrow')">üîí –≠–°–ö–†–û–£</button>
                <button class="tab" onclick="showMarketTab('wallet')">üí≥ –ö–û–®–ï–õ–Å–ö</button>
                <button class="tab" onclick="showMarketTab('auctions')">‚ö° –ê–£–ö–¶–ò–û–ù–´</button>
                <button class="tab" onclick="showMarketTab('forum')">üìã –§–û–†–£–ú</button>
                <button class="tab" id="adminTabButton" onclick="showMarketTab('admin')" style="display: none;">üî¥ –ê–î–ú–ò–ù</button>
            </div>

            <!-- Items Tab -->
            <div id="itemsTab" class="tab-content">
                <div class="items-grid" id="darkItemsGrid">
                    <!-- Dark market items will be loaded here -->
                </div>
            </div>

            <!-- Gangs Tab -->
            <div id="gangsTab" class="tab-content hidden">
                <div class="gangs-section">
                    <h3 style="color: #dc2626; margin-bottom: 2rem;">üë• –î–æ—Å—Ç—É–ø–Ω—ã–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏</h3>
                    <div id="gangsGrid">
                        <!-- Gangs will be loaded here -->
                    </div>
                    
                    <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                        <h4 style="color: #dc2626; margin-bottom: 1rem;">‚ûï –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É</h4>
                        <input type="text" id="newGangName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                        <button class="btn-dark" onclick="createGang()">–°–û–ó–î–ê–¢–¨</button>
                    </div>
                </div>
            </div>

            <!-- Chat Tab -->
            <div id="chatTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 1rem;">üí¨ –û–±—â–∏–π —á–∞—Ç</h3>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages">
                        <!-- Chat messages will appear here -->
                    </div>
                    <div class="chat-input">
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." onkeypress="if(event.key==='Enter') sendMessage()">
                        <button class="btn-dark" onclick="sendMessage()">–û–¢–ü–†–ê–í–ò–¢–¨</button>
                    </div>
                </div>
            </div>

            <!-- My Items Tab -->
            <div id="myItemsTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 2rem;">üì¶ –ú–û–ò –¢–û–í–ê–†–´</h3>
                <div class="items-grid" id="myItemsGrid">
                    <!-- User's items will be loaded here -->
                </div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                    <h4 style="color: #dc2626; margin-bottom: 1rem;">‚ûï –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h4>
                    <input type="text" id="newItemName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <select id="newItemCategory" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                        <option value="–û—Ä—É–∂–∏–µ">–û—Ä—É–∂–∏–µ</option>
                        <option value="–î–æ–∫—É–º–µ–Ω—Ç—ã">–î–æ–∫—É–º–µ–Ω—Ç—ã</option>
                        <option value="–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞">–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞</option>
                        <option value="–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞">–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞</option>
                        <option value="–î—Ä—É–≥–æ–µ">–î—Ä—É–≥–æ–µ</option>
                    </select>
                    <input type="number" id="newItemPrice" placeholder="–¶–µ–Ω–∞ (—Ä—É–±)" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <textarea id="newItemDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px; min-height: 80px;"></textarea>
                    <button class="btn-dark" onclick="addNewItem()">–î–û–ë–ê–í–ò–¢–¨</button>
                </div>
            </div>

            <!-- Profile Tab -->
            <div id="profileTab" class="tab-content hidden">
                <div id="profileContent" style="background: var(--dark-surface); padding: 2rem; border-radius: 10px;"></div>
            </div>

            <!-- Escrow Tab -->
            <div id="escrowTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 2rem;">üîí –≠–°–ö–†–û–£ –°–î–ï–õ–ö–ò</h3>
                <div id="escrowList"></div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                    <h4 style="color: #dc2626; margin-bottom: 1rem;">‚ûï –°–æ–∑–¥–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–¥–µ–ª–∫—É</h4>
                    <input type="text" id="escrowBuyer" placeholder="–õ–æ–≥–∏–Ω –ø–æ–∫—É–ø–∞—Ç–µ–ª—è" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <input type="number" id="escrowAmount" placeholder="–°—É–º–º–∞ —Å–¥–µ–ª–∫–∏" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <textarea id="escrowDescription" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞/—É—Å–ª—É–≥–∏" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px; min-height: 60px;"></textarea>
                    <button class="btn-dark" onclick="createEscrow()">–°–û–ó–î–ê–¢–¨ –°–î–ï–õ–ö–£</button>
                </div>
            </div>

            <!-- Wallet Tab -->
            <div id="walletTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 2rem;">üí≥ –ö–†–ò–ü–¢–û–í–ê–õ–Æ–¢–ù–´–ô –ö–û–®–ï–õ–Å–ö</h3>
                <div id="walletContent" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem;"></div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                    <h4 style="color: #dc2626; margin-bottom: 1rem;">üìä –ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</h4>
                    <div id="transactionHistory" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
            </div>

            <!-- Auctions Tab -->
            <div id="auctionsTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 2rem;">‚ö° –ê–£–ö–¶–ò–û–ù–´</h3>
                <div id="auctionsList" class="items-grid"></div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                    <h4 style="color: #dc2626; margin-bottom: 1rem;">‚ûï –°–æ–∑–¥–∞—Ç—å –∞—É–∫—Ü–∏–æ–Ω</h4>
                    <input type="text" id="auctionName" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ –ª–æ—Ç–∞" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <input type="number" id="auctionStart" placeholder="–ù–∞—á–∞–ª—å–Ω–∞—è —Ü–µ–Ω–∞" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <input type="number" id="auctionDuration" placeholder="–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω—É—Ç—ã)" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <button class="btn-dark" onclick="createAuction()">–°–û–ó–î–ê–¢–¨ –ê–£–ö–¶–ò–û–ù</button>
                </div>
            </div>

            <!-- Forum Tab -->
            <div id="forumTab" class="tab-content hidden">
                <h3 style="color: #dc2626; margin-bottom: 2rem;">üìã –§–û–†–£–ú –ü–õ–û–©–ê–î–ö–ò</h3>
                <div id="forumTopics"></div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: var(--dark-surface); border-radius: 10px;">
                    <h4 style="color: #dc2626; margin-bottom: 1rem;">‚ûï –°–æ–∑–¥–∞—Ç—å —Ç–µ–º—É</h4>
                    <input type="text" id="topicTitle" placeholder="–ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–µ–º—ã" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                    <textarea id="topicContent" placeholder="–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px; min-height: 80px;"></textarea>
                    <button class="btn-dark" onclick="createTopic()">–°–û–ó–î–ê–¢–¨ –¢–ï–ú–£</button>
                </div>
            </div>

            <!-- Admin Panel Tab -->
            <div id="adminTab" class="tab-content hidden">
                <div class="admin-panel">
                    <h2 style="color: var(--dark-red); text-align: center; margin-bottom: 2rem;">üî¥ –ü–ê–ù–ï–õ–¨ –ê–î–ú–ò–ù–ò–°–¢–†–ê–¢–û–†–ê</h2>
                    
                    <div class="admin-stats">
                        <div class="admin-stat-card">
                            <div class="admin-stat-value" id="totalUsers">0</div>
                            <div>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-value" id="totalItems">0</div>
                            <div>–¢–æ–≤–∞—Ä–æ–≤</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-value" id="totalGangs">0</div>
                            <div>–ì—Ä—É–ø–ø–∏—Ä–æ–≤–æ–∫</div>
                        </div>
                        <div class="admin-stat-card">
                            <div class="admin-stat-value" id="totalMessages">0</div>
                            <div>–°–æ–æ–±—â–µ–Ω–∏–π</div>
                        </div>
                    </div>

                    <div class="admin-controls">
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h4>
                            <input type="text" id="adminUserSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è..." style="width: 100%; padding: 0.5rem; margin-bottom: 1rem; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;" oninput="searchUsers()">
                            <div id="usersList" style="max-height: 300px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h4>
                            <div id="adminItemsList" style="max-height: 300px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üè¥ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞–º–∏</h4>
                            <div id="adminGangsList" style="max-height: 300px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üîí –≠—Å–∫—Ä–æ—É —Å–ø–æ—Ä—ã</h4>
                            <div id="adminEscrowList" style="max-height: 300px; overflow-y: auto;"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üí∞ –§–∏–Ω–∞–Ω—Å—ã</h4>
                            <div style="margin-bottom: 1rem;">
                                <div style="font-size: 1.2rem; color: var(--dark-red);">–û–±—â–∏–π –±–∞–ª–∞–Ω—Å: <span id="totalBalance">0</span> ‚ÇΩ</div>
                                <div style="font-size: 0.9rem; color: var(--light-text);">–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–π: <span id="totalTransactions">0</span></div>
                            </div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üìä –õ–æ–≥–∏ –≤—Ö–æ–¥–æ–≤</h4>
                            <div id="adminLogs" style="max-height: 300px; overflow-y: auto; font-size: 0.85rem;"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üìà –ê–Ω–∞–ª–∏—Ç–∏–∫–∞</h4>
                            <div id="adminAnalytics"></div>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–æ—â–∞–¥–∫–∏</h4>
                            <label style="display: flex; align-items: center; margin: 0.5rem 0;">
                                <input type="checkbox" id="registrationEnabled" checked style="margin-right: 0.5rem;">
                                <span>–†–∞–∑—Ä–µ—à–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é</span>
                            </label>
                            <label style="display: flex; align-items: center; margin: 0.5rem 0;">
                                <input type="checkbox" id="invitesRequired" checked style="margin-right: 0.5rem;">
                                <span>–¢—Ä–µ–±–æ–≤–∞—Ç—å –∏–Ω–≤–∞–π—Ç-—Å—Å—ã–ª–∫—É</span>
                            </label>
                            <input type="text" id="accessCode" placeholder="–ö–æ–¥ –¥–æ—Å—Ç—É–ø–∞" value="8052" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                            <button class="btn-dark" onclick="saveSettings()" style="margin-top: 0.5rem;">üíæ –°–û–•–†–ê–ù–ò–¢–¨</button>
                        </div>
                        
                        <div class="admin-section">
                            <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üö® –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è</h4>
                            <button class="btn-dark" onclick="generateInvite()">üîó –ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨ –ò–ù–í–ê–ô–¢</button>
                            <button class="btn-dark" onclick="clearAllData()" style="margin-top: 0.5rem;">üóëÔ∏è –û–ß–ò–°–¢–ò–¢–¨ –î–ê–ù–ù–´–ï</button>
                            <button class="btn-dark" onclick="resetSystem()" style="margin-top: 0.5rem;">üîÑ –°–ë–†–û–° –°–ò–°–¢–ï–ú–´</button>
                            <button class="btn-dark" onclick="exportLogs()" style="margin-top: 0.5rem;">üì• –≠–ö–°–ü–û–†–¢ –õ–û–ì–û–í</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="loginModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('loginModal')">&times;</span>
            <h2>üîë –í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h2>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="loginUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="loginPassword" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <button class="btn btn-primary" onclick="performLogin()">–í–æ–π—Ç–∏</button>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="registerModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('registerModal')">&times;</span>
            <h2>üìù –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
            <div class="form-group">
                <label>–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="registerUsername" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –ª–æ–≥–∏–Ω">
            </div>
            <div class="form-group">
                <label>Email:</label>
                <input type="email" id="registerEmail" placeholder="–í–≤–µ–¥–∏—Ç–µ email">
            </div>
            <div class="form-group">
                <label>–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="registerPassword" placeholder="–°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å">
            </div>
            <div class="form-group">
                <label>–†–æ–ª—å:</label>
                <select id="userRole">
                    <option value="user">–ß–∏—Ç–∞—Ç–µ–ª—å</option>
                    <option value="correspondent">–ö–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç</option>
                </select>
            </div>
            <button class="btn btn-primary" onclick="performRegister()">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </div>
    </div>

    <!-- Service Order Modal -->
    <div id="serviceModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal('serviceModal')">&times;</span>
            <h2>üìã –ó–∞–∫–∞–∑ —É—Å–ª—É–≥–∏</h2>
            <div id="serviceDetails"></div>
            <div class="form-group">
                <label>–í–∞—à–µ –∏–º—è:</label>
                <input type="text" id="clientName" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è">
            </div>
            <div class="form-group">
                <label>–¢–µ–ª–µ—Ñ–æ–Ω:</label>
                <input type="tel" id="clientPhone" placeholder="+7 (xxx) xxx-xx-xx">
            </div>
            <div class="form-group">
                <label>–û–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Ç—É–∞—Ü–∏–∏:</label>
                <textarea id="caseDescription" placeholder="–û–ø–∏—à–∏—Ç–µ –≤–∞—à—É —Å–∏—Ç—É–∞—Ü–∏—é"></textarea>
            </div>
            <button class="btn btn-primary" onclick="submitServiceOrder()">–ó–∞–∫–∞–∑–∞—Ç—å —É—Å–ª—É–≥—É</button>
        </div>
    </div>

    <!-- Dark Web Register Modal -->
    <div id="darkRegisterModal" class="modal">
        <div class="modal-content" style="background: var(--dark-surface); color: var(--dark-text-primary); border: 2px solid var(--dark-red);">
            <span class="close" onclick="closeModal('darkRegisterModal')">&times;</span>
            <h2 style="color: var(--dark-red);">üîí –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ù–ê DARKWEB</h2>
            <div class="form-group">
                <label style="color: var(--dark-red);">–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="darkRegUsername" placeholder="–í—ã–±–µ—Ä–∏—Ç–µ –ª–æ–≥–∏–Ω" style="background: var(--dark-bg); color: white; border: 1px solid var(--dark-red);">
            </div>
            <div class="form-group">
                <label style="color: var(--dark-red);">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="darkRegPassword" placeholder="–°–æ–∑–¥–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å" style="background: var(--dark-bg); color: white; border: 1px solid var(--dark-red);">
            </div>
            <div class="form-group">
                <label style="color: var(--dark-red);">–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å:</label>
                <input type="password" id="darkRegPassword2" placeholder="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="background: var(--dark-bg); color: white; border: 1px solid var(--dark-red);">
            </div>
            <button class="btn-dark" onclick="performDarkRegister()">–°–û–ó–î–ê–¢–¨ –ê–ö–ö–ê–£–ù–¢</button>
            <p style="color: #666; margin-top: 1rem; font-size: 0.9rem;">‚ö†Ô∏è –≠—Ç–æ —Ä–æ–ª–µ–≤–∞—è –∏–≥—Ä–∞</p>
        </div>
    </div>

    <script>
        // Global state management (using in-memory storage instead of localStorage)
        let appState = {
            currentUser: null,
            ranks: [
                { name: "–ù–æ–≤–∏—á–æ–∫", emoji: "üü¢", min: 0, max: 10, canCreate: false, canInvite: false, maxInvites: 0 },
                { name: "–£—á–∞—Å—Ç–Ω–∏–∫", emoji: "üîµ", min: 11, max: 50, canCreate: true, canInvite: false, maxInvites: 0 },
                { name: "–û–ø—ã—Ç–Ω—ã–π", emoji: "üü£", min: 51, max: 100, canCreate: true, canInvite: true, maxInvites: 1 },
                { name: "–≠–∫—Å–ø–µ—Ä—Ç", emoji: "üü†", min: 101, max: 500, canCreate: true, canInvite: true, maxInvites: 3 },
                { name: "–ú–∞—Å—Ç–µ—Ä", emoji: "üî¥", min: 501, max: 1000, canCreate: true, canInvite: true, maxInvites: 5 },
                { name: "–õ–µ–≥–µ–Ω–¥–∞", emoji: "‚≠ê", min: 1001, max: 999999, canCreate: true, canInvite: true, maxInvites: 10 }
            ],
            achievements: [
                { id: 1, name: "–ü–µ—Ä–≤–∞—è —Å–¥–µ–ª–∫–∞", desc: "–°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–µ—Ä–≤—É—é –ø–æ–∫—É–ø–∫—É", reward: 10, icon: "üí∞" },
                { id: 2, name: "–¢–æ—Ä–≥–æ–≤–µ—Ü", desc: "–°–æ–∑–¥–∞–π—Ç–µ 10 –æ–±—ä—è–≤–ª–µ–Ω–∏–π", reward: 50, icon: "üì¶" },
                { id: 3, name: "–õ–µ–≥–µ–Ω–¥–∞", desc: "–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ —Ä–∞–Ω–≥–∞ –õ–µ–≥–µ–Ω–¥–∞", reward: 100, icon: "‚≠ê" },
                { id: 4, name: "–û–±—â–∏—Ç–µ–ª—å–Ω—ã–π", desc: "–û—Ç–ø—Ä–∞–≤—å—Ç–µ 100 —Å–æ–æ–±—â–µ–Ω–∏–π", reward: 20, icon: "üí¨" },
                { id: 5, name: "–ë–∞–Ω–¥–∏—Ç", desc: "–í—Å—Ç—É–ø–∏—Ç–µ –≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É", reward: 15, icon: "üè¥" }
            ],
            notifications: [],
            news: [
                {
                    id: 1,
                    title: "–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π –≤—ã–ø—É—Å–∫: –¢—Ä–∞–≥–µ–¥–∏—è –≤ —Ü–µ–Ω—Ç—Ä–µ –≥–æ—Ä–æ–¥–∞",
                    category: "–ü—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è",
                    date: "23 –æ–∫—Ç—è–±—Ä—è 2025",
                    time: "17:05",
                    preview: "–°–µ–≥–æ–¥–Ω—è –¥–Ω—ë–º –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º —Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Ç—Ä–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ. –ü–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤, –±—ã–ª —É–±–∏—Ç –º–æ–ª–æ–¥–æ–π —á–µ–ª–æ–≤–µ–∫...",
                    content: "–°–µ–≥–æ–¥–Ω—è –¥–Ω—ë–º –≤ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–º —Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Ç—Ä–∞–≥–∏—á–µ—Å–∫–æ–µ —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ—Ç—Ä—è—Å–ª–æ –º–µ—Å—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–æ. –ü–æ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–º –¥–∞–Ω–Ω—ã–º –ø—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤, –æ–∫–æ–ª–æ 14:30 –ø–æ –º–æ—Å–∫–æ–≤—Å–∫–æ–º—É –≤—Ä–µ–º–µ–Ω–∏ –±—ã–ª —É–±–∏—Ç –º–æ–ª–æ–¥–æ–π —á–µ–ª–æ–≤–µ–∫ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ 25-30 –ª–µ—Ç. –ò–Ω—Ü–∏–¥–µ–Ω—Ç –ø—Ä–æ–∏–∑–æ—à—ë–ª –Ω–∞ –æ–¥–Ω–æ–π –∏–∑ –æ–∂–∏–≤–ª—ë–Ω–Ω—ã—Ö —É–ª–∏—Ü –≥–æ—Ä–æ–¥–∞, –Ω–µ–¥–∞–ª–µ–∫–æ –æ—Ç –∂–∏–ª—ã—Ö –∫–≤–∞—Ä—Ç–∞–ª–æ–≤ –∏ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Ç–æ—á–µ–∫.",
                    author: "–ö–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç News Channel 5",
                    views: 342,
                    rating: 4.5,
                    ratings: [5, 4, 5, 4, 5],
                    comments: []
                },
                {
                    id: 2,
                    title: "–ì–æ—Ä–æ–¥—Å–∫–æ–π —Å–æ–≤–µ—Ç –æ–±—Å—É–¥–∏–ª –Ω–æ–≤—ã–π –±—é–¥–∂–µ—Ç",
                    category: "–ü–æ–ª–∏—Ç–∏–∫–∞",
                    date: "23 –æ–∫—Ç—è–±—Ä—è 2025",
                    time: "14:20",
                    preview: "–ù–∞ –∑–∞—Å–µ–¥–∞–Ω–∏–∏ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ —Å–æ–≤–µ—Ç–∞ –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥...",
                    content: "–ù–∞ –∑–∞—Å–µ–¥–∞–Ω–∏–∏ –≥–æ—Ä–æ–¥—Å–∫–æ–≥–æ —Å–æ–≤–µ—Ç–∞ –±—ã–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—é–¥–∂–µ—Ç–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –≥–æ–¥. –û—Å–æ–±–æ–µ –≤–Ω–∏–º–∞–Ω–∏–µ —É–¥–µ–ª–µ–Ω–æ —Ä–∞–∑–≤–∏—Ç–∏—é —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π —Å—Ñ–µ—Ä—ã –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
                    author: "–ü–æ–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç",
                    views: 189,
                    rating: 3.8,
                    ratings: [4, 3, 4, 4],
                    comments: []
                },
                {
                    id: 3,
                    title: "–û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞",
                    category: "–≠–∫–æ–Ω–æ–º–∏–∫–∞",
                    date: "22 –æ–∫—Ç—è–±—Ä—è 2025",
                    time: "18:45",
                    preview: "–í –∑–∞–ø–∞–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞ —Å–æ—Å—Ç–æ—è–ª–æ—Å—å —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫—Ä—É–ø–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞...",
                    content: "–í –∑–∞–ø–∞–¥–Ω–æ–º —Ä–∞–π–æ–Ω–µ –≥–æ—Ä–æ–¥–∞ —Å–æ—Å—Ç–æ—è–ª–æ—Å—å —Ç–æ—Ä–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –∫—Ä—É–ø–Ω–æ–≥–æ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞. –ù–æ–≤—ã–π –∫–æ–º–ø–ª–µ–∫—Å —Å–æ–∑–¥–∞—Å—Ç –±–æ–ª–µ–µ 500 —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç –∏ —Å—Ç–∞–Ω–µ—Ç –≤–∞–∂–Ω—ã–º –æ–±—ä–µ–∫—Ç–æ–º –≥–æ—Ä–æ–¥—Å–∫–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã.",
                    author: "–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π –æ–±–æ–∑—Ä–µ–≤–∞—Ç–µ–ª—å",
                    views: 256,
                    rating: 4.2,
                    ratings: [4, 5, 4, 4],
                    comments: []
                }
            ],
            services: [
                {
                    id: 1,
                    name: "–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ —É–≥–æ–ª–æ–≤–Ω—ã–º –¥–µ–ª–∞–º",
                    description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—è –ø–æ —É–≥–æ–ª–æ–≤–Ω—ã–º –¥–µ–ª–∞–º –ª—é–±–æ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏",
                    price: "5000 ‚ÇΩ",
                    duration: "1 —á–∞—Å"
                },
                {
                    id: 2,
                    name: "–ó–∞—â–∏—Ç–∞ –≤ —Å—É–¥–µ",
                    description: "–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤ –∫–ª–∏–µ–Ω—Ç–∞ –≤ —Å—É–¥–µ",
                    price: "–æ—Ç 50000 ‚ÇΩ",
                    duration: "–ø–æ –¥–æ–≥–æ–≤–æ—Ä—É"
                },
                {
                    id: 3,
                    name: "–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
                    description: "–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏—Å–∫–æ–≤, –∂–∞–ª–æ–± –∏ –¥—Ä—É–≥–∏—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤",
                    price: "–æ—Ç 3000 ‚ÇΩ",
                    duration: "1-3 –¥–Ω—è"
                }
            ],
            darkItems: [
                {
                    id: 1,
                    name: "üî´ –ü–∏—Å—Ç–æ–ª–µ—Ç Glock 17",
                    category: "–û—Ä—É–∂–∏–µ",
                    price: "150000 ‚ÇΩ",
                    seller: "Phantom_Dealer",
                    rating: 4.8,
                    description: "9–º–º, –ø–æ–ª–Ω–∞—è –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è, 2 –º–∞–≥–∞–∑–∏–Ω–∞"
                },
                {
                    id: 2,
                    name: "üèπ –ê–ö-47",
                    category: "–û—Ä—É–∂–∏–µ",
                    price: "250000 ‚ÇΩ",
                    seller: "Shadow_Arms",
                    rating: 4.9,
                    description: "–ö–∞–ª–∏–±—Ä 7.62, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ"
                },
                {
                    id: 3,
                    name: "üíä –ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã",
                    category: "–§–∞—Ä–º–∞—Ü–µ–≤—Ç–∏–∫–∞",
                    price: "–æ—Ç 5000 ‚ÇΩ",
                    seller: "MedSupply_Pro",
                    rating: 4.6,
                    description: "–†–∞–∑–ª–∏—á–Ω—ã–µ –ø—Ä–µ–ø–∞—Ä–∞—Ç—ã, –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞"
                },
                {
                    id: 4,
                    name: "üìÑ –ü–æ–¥–¥–µ–ª—å–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã",
                    category: "–î–æ–∫—É–º–µ–Ω—Ç—ã",
                    price: "–æ—Ç 30000 ‚ÇΩ",
                    seller: "DocMaster",
                    rating: 4.7,
                    description: "–ü–∞—Å–ø–æ—Ä—Ç–∞, –ø—Ä–∞–≤–∞, –¥–∏–ø–ª–æ–º—ã"
                },
                {
                    id: 5,
                    name: "üí£ –í–∑—Ä—ã–≤—á–∞—Ç–∫–∞ C4",
                    category: "–í–∑—Ä—ã–≤—á–∞—Ç—ã–µ –≤–µ—â–µ—Å—Ç–≤–∞",
                    price: "200000 ‚ÇΩ",
                    seller: "Bomber_Elite",
                    rating: 4.5,
                    description: "1–∫–≥, –¥–µ—Ç–æ–Ω–∞—Ç–æ—Ä –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ"
                }
            ],
            gangs: [
                {
                    id: 1,
                    name: "–ö—Ä–∞—Å–Ω—ã–µ –í–æ–ª–∫–∏",
                    members: 47,
                    territory: "–°–µ–≤–µ—Ä–Ω—ã–π —Ä–∞–π–æ–Ω",
                    reputation: 850,
                    leader: "RedWolf_Boss"
                },
                {
                    id: 2,
                    name: "–ß—ë—Ä–Ω—ã–µ –¢–µ–Ω–∏",
                    members: 38,
                    territory: "–¶–µ–Ω—Ç—Ä",
                    reputation: 720,
                    leader: "Dark_Shadow"
                }
            ],
            chatMessages: [
                { author: "ShadowMaster", text: "–ö—Ç–æ-–Ω–∏–±—É–¥—å —Ç–æ—Ä–≥—É–µ—Ç –æ—Ä—É–∂–∏–µ–º?", time: "17:23" },
                { author: "DarkTrader", text: "–ï—Å—Ç—å –ø–∏—Å—Ç–æ–ª–µ—Ç—ã –≤ –Ω–∞–ª–∏—á–∏–∏", time: "17:25" },
                { author: "RedWolf_Boss", text: "–ö—Ä–∞—Å–Ω—ã–µ –í–æ–ª–∫–∏ –Ω–∞–±–∏—Ä–∞—é—Ç –Ω–æ–≤—ã—Ö —á–ª–µ–Ω–æ–≤", time: "17:30" }
            ],
            users: {},
            darkUsers: {},
            currentDarkUser: null,
            isDarkMode: false,
            userBalance: 50000,
            userGang: null,
            blockedUsers: {},
            failedAttempts: {},
            validInvites: [
                'https://invite.to/rp-market/sukcdik',
                'https://invite.to/rp-market/fbi', 
                'https://invite.to/rp-market/olele'
            ]
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
        
        function initializeApp() {
            loadNews();
            loadServices();
            startDarkWebEffects();
            initializeDarkWebData();
        }
        
        function initializeDarkWebData() {
            // Initialize default admin users if they don't exist
            if (!appState.darkUsers['admin']) {
                appState.darkUsers['admin'] = {
                    username: 'admin',
                    password: btoa('admin123'),
                    role: 'darkweb_admin',
                    balance: 1000000,
                    reputation: 1000,
                    experience: 5000,
                    items: [],
                    gang: null,
                    avatar: 'üëë',
                    bio: '–ì–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–ª–æ—â–∞–¥–∫–∏',
                    registered: '01.01.2024',
                    deals: 0,
                    reviews: [],
                    achievements: [],
                    invitesUsed: 0,
                    loginHistory: [],
                    actionHistory: [],
                    wallets: { btc: 10.5, eth: 50.2, usdt: 100000 }
                };
            }
            
            if (!appState.darkUsers['owner']) {
                appState.darkUsers['owner'] = {
                    username: 'owner',
                    password: btoa('owner666'),
                    role: 'darkweb_admin',
                    balance: 5000000,
                    reputation: 1000,
                    experience: 10000,
                    items: [],
                    gang: null,
                    avatar: '‚≠ê',
                    bio: '–í–ª–∞–¥–µ–ª–µ—Ü –ø–ª–æ—â–∞–¥–∫–∏',
                    registered: '01.01.2023',
                    deals: 0,
                    reviews: [],
                    achievements: [],
                    invitesUsed: 0,
                    loginHistory: [],
                    actionHistory: [],
                    wallets: { btc: 100.0, eth: 500.0, usdt: 5000000 }
                };
            }
            
            // Add some default sellers if they don't exist
            const defaultSellers = [
                { username: 'Phantom_Dealer', balance: 500000 },
                { username: 'Shadow_Arms', balance: 750000 },
                { username: 'MedSupply_Pro', balance: 300000 },
                { username: 'DocMaster', balance: 400000 },
                { username: 'Bomber_Elite', balance: 600000 }
            ];
            
            defaultSellers.forEach(seller => {
                if (!appState.darkUsers[seller.username]) {
                    appState.darkUsers[seller.username] = {
                        username: seller.username,
                        password: btoa('seller123'),
                        role: 'darkweb_user',
                        balance: seller.balance,
                        reputation: Math.floor(Math.random() * 500) + 200,
                        experience: Math.floor(Math.random() * 300) + 50,
                        items: [],
                        gang: null,
                        avatar: 'üé≠',
                        bio: '–û–ø—ã—Ç–Ω—ã–π –ø—Ä–æ–¥–∞–≤–µ—Ü',
                        registered: '15.06.2024',
                        deals: Math.floor(Math.random() * 50) + 10,
                        reviews: [],
                        achievements: [],
                        invitesUsed: 0,
                        loginHistory: [],
                        actionHistory: [],
                        wallets: { btc: Math.random() * 5, eth: Math.random() * 20, usdt: seller.balance }
                    };
                }
            });
        }

        // Navigation functions
        function showSection(section) {
            // Hide all sections
            document.getElementById('homeSection').classList.add('hidden');
            document.getElementById('aboutSection').classList.add('hidden');
            document.getElementById('servicesSection').classList.add('hidden');
            
            // Show selected section
            document.getElementById(section + 'Section').classList.remove('hidden');
        }

        // Authentication functions
        function showLogin() {
            document.getElementById('loginModal').style.display = 'block';
        }

        function showRegister() {
            document.getElementById('registerModal').style.display = 'block';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function performLogin() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (!username || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            // Special dark web login
            if (username === 'dark' && password === 'web') {
                closeModal('loginModal');
                startDarkWebEntry();
                return;
            }

            // Regular login
            if (appState.users[username] && appState.users[username].password === password) {
                appState.currentUser = appState.users[username];
                updateUserInterface();
                closeModal('loginModal');
                alert('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ' + username + '!');
            } else {
                alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å');
            }
        }

        function performRegister() {
            const username = document.getElementById('registerUsername').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const role = document.getElementById('userRole').value;

            if (!username || !email || !password) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            if (appState.users[username]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }

            appState.users[username] = {
                username: username,
                email: email,
                password: password,
                role: role
            };

            alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.');
            closeModal('registerModal');
        }

        function logout() {
            appState.currentUser = null;
            updateUserInterface();
            alert('–í—ã –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã');
        }

        function updateUserInterface() {
            if (appState.currentUser) {
                document.getElementById('authButtons').classList.add('hidden');
                document.getElementById('userInfo').classList.remove('hidden');
                document.getElementById('userName').textContent = 'üë§ ' + appState.currentUser.username;
                
                // Show correspondent panel if user is correspondent
                if (appState.currentUser.role === 'correspondent') {
                    document.getElementById('correspondentPanel').classList.remove('hidden');
                }
            } else {
                document.getElementById('authButtons').classList.remove('hidden');
                document.getElementById('userInfo').classList.add('hidden');
                document.getElementById('correspondentPanel').classList.add('hidden');
            }
        }

        // News functions
        function filterNews() {
            const search = document.getElementById('newsSearch').value.toLowerCase();
            const category = document.getElementById('categoryFilter').value;
            const sort = document.getElementById('sortOrder').value;
            
            let filtered = appState.news.filter(n => {
                const matchSearch = n.title.toLowerCase().includes(search) || n.preview.toLowerCase().includes(search);
                const matchCategory = category === 'all' || n.category === category;
                return matchSearch && matchCategory;
            });
            
            // Sort
            if (sort === 'popular') {
                filtered.sort((a, b) => (b.rating || 0) - (a.rating || 0));
            } else if (sort === 'views') {
                filtered.sort((a, b) => (b.views || 0) - (a.views || 0));
            }
            
            displayNews(filtered);
        }
        
        function loadNews() {
            displayNews(appState.news);
        }
        
        function displayNews(newsArray) {
            const newsGrid = document.getElementById('newsGrid');
            newsGrid.innerHTML = '';

            newsArray.forEach(news => {
                const newsCard = document.createElement('div');
                newsCard.className = 'news-card';
                
                // Check if current user is the author and can delete
                const canDelete = appState.currentUser && 
                                 (appState.currentUser.username === news.author || appState.currentUser.role === 'admin');
                
                const deleteButton = canDelete ? 
                    `<button class="delete-btn" onclick="deleteNews(${news.id})" style="margin-top: 1rem;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>` : '';
                
                newsCard.innerHTML = `
                    <div class="news-content">
                        <div class="news-meta">
                            <span class="news-category">${news.category}</span>
                            <span>${news.date} ${news.time}</span>
                        </div>
                        <h3 onclick="openNewsDetail(${news.id})" style="cursor: pointer; color: var(--primary-color);">${news.title}</h3>
                        <p class="news-preview">${news.preview}</p>
                        <div style="display: flex; justify-content: space-between; margin: 1rem 0; font-size: 0.9rem; color: var(--light-text);">
                            <span>‚úçÔ∏è ${news.author}</span>
                            <span>üëÅÔ∏è ${news.views || 0} –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤</span>
                        </div>
                        <div style="display: flex; gap: 0.5rem; margin: 1rem 0;">
                            <button class="btn btn-primary" onclick="openNewsDetail(${news.id})" style="padding: 0.5rem 1rem;">üìù –ß–∏—Ç–∞—Ç—å</button>
                            <button class="btn btn-secondary" onclick="rateNews(${news.id})" style="padding: 0.5rem 1rem;">‚≠ê –û—Ü–µ–Ω–∏—Ç—å</button>
                            <button class="btn btn-secondary" onclick="shareNews(${news.id})" style="padding: 0.5rem 1rem;">üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è</button>
                        </div>
                        <div style="display: flex; align-items: center; gap: 1rem;">
                            <span style="color: #f59e0b;">‚òÖ ${(news.rating || 0).toFixed(1)}</span>
                            <span style="color: var(--light-text);">üí¨ ${(news.comments || []).length} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤</span>
                        </div>
                        ${deleteButton}
                    </div>
                `;
                newsGrid.appendChild(newsCard);
            });
        }
        
        function deleteNews(newsId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?')) {
                appState.news = appState.news.filter(news => news.id !== newsId);
                loadNews();
                alert('–ù–æ–≤–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞!');
            }
        }
        
        function openNewsDetail(newsId) {
            const news = appState.news.find(n => n.id === newsId);
            if (!news) return;
            
            // Increment views
            if (!news.views) news.views = 0;
            news.views++;
            
            if (!news.comments) news.comments = [];
            
            let commentSection = news.comments.map((c, i) => 
                `\n\n[üë§ ${c.author}] (${c.time}):\n${c.text}\n‚ô• ${c.likes || 0}`
            ).join('');
            
            let fullText = `${news.title}\n\n–ê–≤—Ç–æ—Ä: ${news.author}\nüìÖ ${news.date} ${news.time}\n‚≠ê –†–µ–π—Ç–∏–Ω–≥: ${(news.rating || 0).toFixed(1)}\nüëÅÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–æ–≤: ${news.views}\n\n${news.content}${commentSection ? '\n\n--- –ö–û–ú–ú–ï–ù–¢–ê–†–ò–ò ---' + commentSection : ''}`;
            
            alert(fullText);
            
            // Offer to comment
            if (appState.currentUser) {
                const comment = prompt('–û—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π:');
                if (comment && comment.trim()) {
                    news.comments.push({
                        author: appState.currentUser.username,
                        text: comment,
                        time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }),
                        likes: 0
                    });
                    alert('‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω!');
                    loadNews();
                }
            }
        }
        
        function rateNews(newsId) {
            const news = appState.news.find(n => n.id === newsId);
            if (!news) return;
            
            const rating = prompt('–û—Ü–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ç—å—é (1-5):', '5');
            const rate = parseInt(rating);
            
            if (rate >= 1 && rate <= 5) {
                if (!news.ratings) news.ratings = [];
                news.ratings.push(rate);
                news.rating = news.ratings.reduce((a, b) => a + b, 0) / news.ratings.length;
                alert(`‚úÖ –°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ü–µ–Ω–∫—É!\n–°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥: ${news.rating.toFixed(1)} ‚≠ê`);
                loadNews();
            }
        }
        
        function shareNews(newsId) {
            const news = appState.news.find(n => n.id === newsId);
            if (!news) return;
            
            const shareUrl = `https://truenews.ru/news/${newsId}`;
            const shareText = `${news.title}\n\n${shareUrl}`;
            
            const platform = prompt('–ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤:\n1. VK\n2. Telegram\n3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É', '3');
            
            if (platform === '1') {
                alert('üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ VK:\nvk.com/share.php?url=' + encodeURIComponent(shareUrl));
            } else if (platform === '2') {
                alert('üîó –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –≤ Telegram:\nt.me/share/url?url=' + encodeURIComponent(shareUrl));
            } else {
                alert('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!\n\n' + shareUrl);
            }
        }

        function publishNews() {
            if (!appState.currentUser || appState.currentUser.role !== 'correspondent') {
                alert('–¢–æ–ª—å–∫–æ –∫–æ—Ä—Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç—ã –º–æ–≥—É—Ç –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–æ–≤–æ—Å—Ç–∏');
                return;
            }

            const title = document.getElementById('newsTitle').value;
            const category = document.getElementById('newsCategory').value;
            const preview = document.getElementById('newsPreview').value;
            const content = document.getElementById('newsContent').value;

            if (!title || !preview || !content) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            const now = new Date();
            const newNews = {
                id: appState.news.length + 1,
                title: title,
                category: category,
                date: now.toLocaleDateString('ru-RU'),
                time: now.toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' }),
                preview: preview,
                content: content,
                author: appState.currentUser.username
            };

            appState.news.unshift(newNews);
            loadNews();
            
            // Clear form
            document.getElementById('newsTitle').value = '';
            document.getElementById('newsPreview').value = '';
            document.getElementById('newsContent').value = '';
            
            alert('–ù–æ–≤–æ—Å—Ç—å —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞!');
        }

        // Services functions
        function loadServices() {
            const servicesGrid = document.getElementById('servicesGrid');
            servicesGrid.innerHTML = '';

            appState.services.forEach(service => {
                const serviceCard = document.createElement('div');
                serviceCard.className = 'service-card';
                serviceCard.innerHTML = `
                    <h3>${service.name}</h3>
                    <p>${service.description}</p>
                    <div class="service-price">${service.price}</div>
                    <p style="color: var(--light-text);">‚è±Ô∏è ${service.duration}</p>
                    <button class="btn btn-primary" onclick="orderService(${service.id})">–ó–∞–∫–∞–∑–∞—Ç—å</button>
                `;
                servicesGrid.appendChild(serviceCard);
            });
        }

        function orderService(serviceId) {
            const service = appState.services.find(s => s.id === serviceId);
            document.getElementById('serviceDetails').innerHTML = `
                <h3>${service.name}</h3>
                <p>${service.description}</p>
                <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> ${service.price}</p>
                <p><strong>–°—Ä–æ–∫:</strong> ${service.duration}</p>
                <hr style="margin: 1rem 0;">
            `;
            document.getElementById('serviceModal').style.display = 'block';
        }

        function submitServiceOrder() {
            const name = document.getElementById('clientName').value;
            const phone = document.getElementById('clientPhone').value;
            const description = document.getElementById('caseDescription').value;

            if (!name || !phone || !description) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }

            alert('–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞! –ê–¥–≤–æ–∫–∞—Ç —Å–≤—è–∂–µ—Ç—Å—è —Å –≤–∞–º–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.');
            closeModal('serviceModal');
        }

        // Dark Web functions with multi-step verification
        function startDarkWebEntry() {
            document.getElementById('mainSite').classList.add('hidden');
            document.getElementById('darkLoading').classList.remove('hidden');
            
            startMatrixEffect();
            simulateLoading();
        }
        
        function startMatrixEffect() {
            const matrixBg = document.getElementById('matrixBg');
            matrixBg.innerHTML = '';
            
            const chars = '–ê–ë–í–ì–î–ï–ñ–ó–ò–ö–õ–ú–ù–û–ü–†–°–¢–£–§–•–¶–ß–®–≠–Æ–Ø0123456789!@#$%^&*()';
            
            for (let i = 0; i < 20; i++) {
                const column = document.createElement('div');
                column.className = 'matrix-column';
                column.style.left = Math.random() * 100 + '%';
                column.style.animationDuration = (Math.random() * 3 + 2) + 's';
                column.style.animationDelay = Math.random() * 2 + 's';
                
                let text = '';
                for (let j = 0; j < 20; j++) {
                    text += chars.charAt(Math.floor(Math.random() * chars.length)) + '<br>';
                }
                column.innerHTML = text;
                
                matrixBg.appendChild(column);
            }
        }
        
        function simulateLoading() {
            const progressFill = document.getElementById('progressFill');
            const loadingText = document.getElementById('loadingText');
            
            const messages = [
                'CONNECTING TO DARK NET...',
                'ESTABLISHING ENCRYPTED CONNECTION...',
                'BYPASSING SECURITY PROTOCOLS...',
                'ACCESSING HIDDEN SERVICES...',
                'CONNECTION ESTABLISHED'
            ];
            
            let progress = 0;
            let messageIndex = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                progressFill.style.width = Math.min(progress, 100) + '%';
                
                if (messageIndex < messages.length - 1 && progress > (messageIndex + 1) * 20) {
                    messageIndex++;
                    loadingText.textContent = messages[messageIndex];
                }
                
                if (progress >= 100) {
                    clearInterval(interval);
                    setTimeout(() => {
                        document.getElementById('darkLoading').classList.add('hidden');
                        document.getElementById('darkVerification1').classList.remove('hidden');
                    }, 1000);
                }
            }, 200);
        }
        
        function verifyStep1() {
            const code = document.getElementById('verificationCode').value;
            if (code === '678') {
                document.getElementById('darkVerification1').classList.add('hidden');
                document.getElementById('darkVerification2').classList.remove('hidden');
                addGlitchEffect();
            } else {
                alert('‚ùå –ù–ï–í–ï–†–ù–´–ô –ö–û–î –î–û–°–¢–£–ü–ê');
                document.getElementById('verificationCode').value = '';
            }
        }
        
        function verifyStep2() {
            const link = document.getElementById('inviteLink').value;
            if (appState.validInvites.includes(link)) {
                document.getElementById('darkVerification2').classList.add('hidden');
                document.getElementById('darkVerification3').classList.remove('hidden');
                addGlitchEffect();
            } else {
                alert('‚ùå –ù–ï–î–ï–ô–°–¢–í–ò–¢–ï–õ–¨–ù–ê–Ø –°–°–´–õ–ö–ê');
                document.getElementById('inviteLink').value = '';
            }
        }
        
        function verifyStep3() {
            const username = document.getElementById('darkUsername').value;
            const password = document.getElementById('darkPassword').value;
            
            if (!username || !password) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            // Check for blocked users
            if (appState.blockedUsers[username]) {
                const blockTime = appState.blockedUsers[username];
                const now = Date.now();
                if (now < blockTime) {
                    const remainingTime = Math.ceil((blockTime - now) / 1000);
                    alert(`‚ùå –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù. –û—Å—Ç–∞–ª–æ—Å—å: ${remainingTime} —Å–µ–∫.`);
                    return;
                } else {
                    delete appState.blockedUsers[username];
                }
            }
            
            // Check credentials
            if (appState.darkUsers[username] && appState.darkUsers[username].password === btoa(password)) {
                appState.currentDarkUser = appState.darkUsers[username];
                delete appState.failedAttempts[username];
                
                // Log login
                if (!appState.currentDarkUser.loginHistory) appState.currentDarkUser.loginHistory = [];
                appState.currentDarkUser.loginHistory.push({
                    time: new Date().toLocaleString('ru-RU'),
                    ip: '127.0.0.' + Math.floor(Math.random() * 255),
                    device: 'Browser'
                });
                
                // Daily login bonus
                addExperience(1, '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –≤—Ö–æ–¥');
                
                enterDarkMarket();
                showWelcomeMessage();
            } else {
                // Handle failed login
                if (!appState.failedAttempts[username]) {
                    appState.failedAttempts[username] = 0;
                }
                appState.failedAttempts[username]++;
                
                if (appState.failedAttempts[username] >= 3) {
                    appState.blockedUsers[username] = Date.now() + 300000; // 5 minutes
                    alert('‚ùå –°–õ–ò–®–ö–û–ú –ú–ù–û–ì–û –ù–ï–£–î–ê–ß–ù–´–• –ü–û–ü–´–¢–û–ö. –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –ó–ê–ë–õ–û–ö–ò–†–û–í–ê–ù –ù–ê 5 –ú–ò–ù–£–¢.');
                } else {
                    alert(`‚ùå –ù–ï–í–ï–†–ù–´–ï –î–ê–ù–ù–´–ï. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: ${3 - appState.failedAttempts[username]}`);
                }
                document.getElementById('darkPassword').value = '';
            }
        }
        
        function showDarkRegister() {
            document.getElementById('darkRegisterModal').style.display = 'block';
        }
        
        function performDarkRegister() {
            const username = document.getElementById('darkRegUsername').value;
            const password = document.getElementById('darkRegPassword').value;
            const password2 = document.getElementById('darkRegPassword2').value;
            
            if (!username || !password || !password2) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (password !== password2) {
                alert('–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç');
                return;
            }
            
            if (appState.darkUsers[username]) {
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –ª–æ–≥–∏–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç');
                return;
            }
            
            appState.darkUsers[username] = {
                username: username,
                password: btoa(password),
                role: 'darkweb_user',
                balance: 25000,
                reputation: 0,
                experience: 0,
                items: [],
                gang: null,
                avatar: 'üé≠',
                bio: '',
                registered: new Date().toLocaleDateString('ru-RU'),
                deals: 0,
                reviews: [],
                achievements: [],
                invitesUsed: 0,
                loginHistory: [],
                actionHistory: [],
                wallets: { btc: 0, eth: 0, usdt: 25000 }
            };
            
            closeModal('darkRegisterModal');
            alert('–ê–∫–∫–∞—É–Ω—Ç —Å–æ–∑–¥–∞–Ω! –¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –≤–æ–π—Ç–∏.');
        }
        
        function enterDarkMarket() {
            document.getElementById('darkVerification3').classList.add('hidden');
            document.getElementById('darkMarket').classList.remove('hidden');
            appState.isDarkMode = true;
            loadDarkMarket();
            updateDarkUserInterface();
            addGlitchEffect();
        }
        
        function updateDarkUserInterface() {
            if (appState.currentDarkUser) {
                document.getElementById('userBalance').textContent = appState.currentDarkUser.balance;
                
                // Show admin panel if user is admin or owner
                if (appState.currentDarkUser.username === 'admin' || appState.currentDarkUser.username === 'owner') {
                    document.getElementById('adminTabButton').style.display = 'block';
                    appState.currentDarkUser.role = 'darkweb_admin';
                }
            }
        }

        function exitDarkMarket() {
            appState.isDarkMode = false;
            appState.currentDarkUser = null;
            document.getElementById('darkMarket').classList.add('hidden');
            document.getElementById('mainSite').classList.remove('hidden');
            document.getElementById('adminTabButton').style.display = 'none';
        }

        function loadDarkMarket() {
            loadDarkItems();
            loadGangs();
            loadChat();
        }

        function filterMarketItems() {
            const search = document.getElementById('marketSearch').value.toLowerCase();
            const category = document.getElementById('marketCategory').value;
            const priceMin = parseInt(document.getElementById('priceMin').value) || 0;
            const priceMax = parseInt(document.getElementById('priceMax').value) || Infinity;
            const sort = document.getElementById('marketSort').value;
            
            let filtered = appState.darkItems.filter(item => {
                const price = parseInt(item.price.replace(/[^0-9]/g, ''));
                const matchSearch = item.name.toLowerCase().includes(search) || item.description.toLowerCase().includes(search);
                const matchCategory = category === 'all' || item.category === category;
                const matchPrice = price >= priceMin && price <= priceMax;
                return matchSearch && matchCategory && matchPrice;
            });
            
            // Sort
            if (sort === 'cheap') {
                filtered.sort((a, b) => parseInt(a.price.replace(/[^0-9]/g, '')) - parseInt(b.price.replace(/[^0-9]/g, '')));
            } else if (sort === 'expensive') {
                filtered.sort((a, b) => parseInt(b.price.replace(/[^0-9]/g, '')) - parseInt(a.price.replace(/[^0-9]/g, '')));
            } else if (sort === 'popular') {
                filtered.sort((a, b) => (b.rating || 0) - (a.rating || 0));
            }
            
            displayDarkItems(filtered);
        }
        
        function loadDarkItems() {
            displayDarkItems(appState.darkItems);
        }
        
        function displayDarkItems(itemsArray) {
            const itemsGrid = document.getElementById('darkItemsGrid');
            itemsGrid.innerHTML = '';

            itemsArray.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'item-card';
                itemCard.innerHTML = `
                    <div class="item-name">${item.name}</div>
                    <div class="item-price">${item.price}</div>
                    <div class="seller-info">
                        <span>üë§ ${item.seller}</span>
                        <span class="rating">‚≠ê ${item.rating}</span>
                    </div>
                    <p style="margin: 1rem 0; font-size: 0.9rem;">${item.description}</p>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn-dark" onclick="buyItem(${item.id})">üí∞ –ö–£–ü–ò–¢–¨</button>
                        <button class="btn-dark" onclick="viewSellerProfile('${item.seller}')" style="background: var(--dark-surface);">üë§ –ü–†–û–§–ò–õ–¨</button>
                    </div>
                `;
                itemsGrid.appendChild(itemCard);
            });
        }

        function buyItem(itemId) {
            if (!appState.currentDarkUser) {
                alert('–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç');
                return;
            }
            
            const item = appState.darkItems.find(i => i.id === itemId);
            const price = parseInt(item.price.replace(/[^0-9]/g, ''));
            
            if (appState.currentDarkUser.balance >= price) {
                appState.currentDarkUser.balance -= price;
                document.getElementById('userBalance').textContent = appState.currentDarkUser.balance;
                
                // Add to seller's balance (if seller exists)
                if (appState.darkUsers[item.seller]) {
                    appState.darkUsers[item.seller].balance += Math.floor(price * 0.9); // 90% to seller
                    appState.darkUsers[item.seller].deals = (appState.darkUsers[item.seller].deals || 0) + 1;
                }
                
                // Add experience for deal
                appState.currentDarkUser.deals++;
                addExperience(10, '–£—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞');
                checkAchievements();
                
                alert(`‚úÖ –ü–æ–∫—É–ø–∫–∞ —Å–æ–≤–µ—Ä—à–µ–Ω–∞: ${item.name}\n–ü—Ä–æ–¥–∞–≤–µ—Ü: ${item.seller}\n\n+10 –æ–ø—ã—Ç–∞ –∑–∞ —Å–¥–µ–ª–∫—É!\n\n‚ö†Ô∏è –í–ù–ò–ú–ê–ù–ò–ï: –≠—Ç–æ —Ä–æ–ª–µ–≤–∞—è –∏–≥—Ä–∞!`);
                addGlitchEffect();
                
                // Open chat with seller
                openSellerChat(item.seller);
            } else {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
            }
        }
        
        function openSellerChat(sellerName) {
            const chatMessage = `–ü—Ä–∏–≤–µ—Ç, ${sellerName}! –Ø –∫—É–ø–∏–ª —É –≤–∞—Å —Ç–æ–≤–∞—Ä. –ö–æ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–∂–∏–¥–∞—Ç—å –¥–æ—Å—Ç–∞–≤–∫—É?`;
            
            // Auto-add message to chat
            appState.chatMessages.push({
                author: appState.currentDarkUser.username,
                text: chatMessage,
                time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })
            });
            
            // Show chat tab
            showMarketTab('chat');
            loadChat();
        }

        function loadGangs() {
            const gangsGrid = document.getElementById('gangsGrid');
            gangsGrid.innerHTML = '';

            appState.gangs.forEach(gang => {
                const gangCard = document.createElement('div');
                gangCard.className = 'gang-card';
                gangCard.innerHTML = `
                    <div class="gang-name">${gang.name}</div>
                    <div class="gang-stats">
                        <div class="stat">
                            <div class="stat-value">${gang.members}</div>
                            <div class="stat-label">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</div>
                        </div>
                        <div class="stat">
                            <div class="stat-value">${gang.reputation}</div>
                            <div class="stat-label">–†–µ–ø—É—Ç–∞—Ü–∏—è</div>
                        </div>
                    </div>
                    <p>üè¥ –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è: ${gang.territory}</p>
                    <p>üëë –õ–∏–¥–µ—Ä: ${gang.leader}</p>
                    <button class="btn-dark" onclick="joinGang(${gang.id})">–í–°–¢–£–ü–ò–¢–¨</button>
                `;
                gangsGrid.appendChild(gangCard);
            });
        }

        function joinGang(gangId) {
            const gang = appState.gangs.find(g => g.id === gangId);
            appState.userGang = gang;
            gang.members += 1;
            alert(`üè¥ –í—ã –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É "${gang.name}"`);            loadGangs();
            addFreezeEffect();
        }

        function createGang() {
            if (!appState.currentDarkUser) {
                alert('–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç');
                return;
            }
            
            if (appState.currentDarkUser.gang) {
                alert('–í—ã —É–∂–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–µ');
                return;
            }
            
            const name = document.getElementById('newGangName').value;
            if (!name) {
                alert('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏');
                return;
            }

            const newGang = {
                id: appState.gangs.length + 1,
                name: name,
                members: 1,
                territory: '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞',
                reputation: 100,
                leader: appState.currentDarkUser.username,
                treasury: 0,
                inventory: []
            };

            appState.gangs.push(newGang);
            appState.currentDarkUser.gang = name;
            
            // Add experience
            addExperience(5, '–°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏');
            
            loadGangs();
            document.getElementById('newGangName').value = '';
            alert(`üè¥ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ "${name}" —Å–æ–∑–¥–∞–Ω–∞!\n\n+5 –æ–ø—ã—Ç–∞!`);
        }

        function loadChat() {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';

            appState.chatMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.innerHTML = `
                    <div class="message-author">${msg.author}</div>
                    <div class="message-text">${msg.text}</div>
                `;
                chatMessages.appendChild(messageDiv);
            });

            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message) return;
            
            if (!appState.currentDarkUser) {
                alert('–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç');
                return;
            }

            const newMessage = {
                author: appState.currentDarkUser.username,
                text: message,
                time: new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' })
            };

            appState.chatMessages.push(newMessage);
            messageInput.value = '';
            loadChat();
        }

        function showMarketTab(tab) {
            // Hide all tabs
            document.getElementById('itemsTab').classList.add('hidden');
            document.getElementById('gangsTab').classList.add('hidden');
            document.getElementById('chatTab').classList.add('hidden');
            document.getElementById('myItemsTab').classList.add('hidden');
            document.getElementById('profileTab').classList.add('hidden');
            document.getElementById('escrowTab').classList.add('hidden');
            document.getElementById('walletTab').classList.add('hidden');
            document.getElementById('auctionsTab').classList.add('hidden');
            document.getElementById('forumTab').classList.add('hidden');
            document.getElementById('adminTab').classList.add('hidden');
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            // Show selected tab
            document.getElementById(tab + 'Tab').classList.remove('hidden');
            if (event && event.target) {
                event.target.classList.add('active');
            }
            
            // Load specific tab data
            if (tab === 'myItems') {
                loadMyItems();
            } else if (tab === 'profile') {
                loadProfile();
            } else if (tab === 'escrow') {
                loadEscrow();
            } else if (tab === 'wallet') {
                loadWallet();
            } else if (tab === 'auctions') {
                loadAuctions();
            } else if (tab === 'forum') {
                loadForum();
            } else if (tab === 'admin') {
                loadAdminPanel();
            }
        }
        
        // My Items functions
        function loadMyItems() {
            if (!appState.currentDarkUser) return;
            
            const myItemsGrid = document.getElementById('myItemsGrid');
            myItemsGrid.innerHTML = '';
            
            const userItems = appState.darkItems.filter(item => item.seller === appState.currentDarkUser.username);
            
            if (userItems.length === 0) {
                myItemsGrid.innerHTML = '<p style="color: var(--dark-text-secondary); text-align: center;">–£ –≤–∞—Å –Ω–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤</p>';
                return;
            }
            
            userItems.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'item-card';
                itemCard.innerHTML = `
                    <div class="item-name">${item.name}</div>
                    <div class="item-price">${item.price}</div>
                    <p style="margin: 1rem 0; font-size: 0.9rem;">${item.description}</p>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn-dark" onclick="editItem(${item.id})">‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨</button>
                        <button class="delete-btn" onclick="deleteItem(${item.id})">üóëÔ∏è –£–î–ê–õ–ò–¢–¨</button>
                    </div>
                `;
                myItemsGrid.appendChild(itemCard);
            });
        }
        
        function addNewItem() {
            if (!appState.currentDarkUser) {
                alert('–í–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç');
                return;
            }
            
            // Check rank restrictions
            const rank = getUserRank(appState.currentDarkUser.experience);
            if (!rank.canCreate) {
                alert(`‚ùå –î–û–°–¢–£–ü –ó–ê–ü–†–ï–©–Å–ù!\n\n–í–∞—à —Ä–∞–Ω–≥: ${rank.emoji} ${rank.name}\n–î–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π –Ω—É–∂–µ–Ω —Ä–∞–Ω–≥ "–£—á–∞—Å—Ç–Ω–∏–∫" –∏–ª–∏ –≤—ã—à–µ (11+ –æ–ø—ã—Ç–∞)\n\n–í–∞—à –æ–ø—ã—Ç: ${appState.currentDarkUser.experience}`);
                return;
            }
            
            const name = document.getElementById('newItemName').value;
            const category = document.getElementById('newItemCategory').value;
            const price = document.getElementById('newItemPrice').value;
            const description = document.getElementById('newItemDescription').value;
            
            if (!name || !price || !description) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            const newItem = {
                id: appState.darkItems.length + 1,
                name: name,
                category: category,
                price: price + ' ‚ÇΩ',
                seller: appState.currentDarkUser.username,
                rating: 0,
                description: description
            };
            
            appState.darkItems.push(newItem);
            
            // Add experience
            addExperience(5, '–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è');
            
            // Clear form
            document.getElementById('newItemName').value = '';
            document.getElementById('newItemPrice').value = '';
            document.getElementById('newItemDescription').value = '';
            
            alert('‚úÖ –¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω! +5 –æ–ø—ã—Ç–∞');
            loadMyItems();
            loadDarkItems();
        }
        
        // Rank and Experience System
        function getUserRank(exp) {
            for (let rank of appState.ranks) {
                if (exp >= rank.min && exp <= rank.max) {
                    return rank;
                }
            }
            return appState.ranks[0];
        }
        
        function addExperience(amount, reason) {
            if (!appState.currentDarkUser) return;
            
            const oldExp = appState.currentDarkUser.experience;
            const oldRank = getUserRank(oldExp);
            
            appState.currentDarkUser.experience += amount;
            const newRank = getUserRank(appState.currentDarkUser.experience);
            
            // Log action
            appState.currentDarkUser.actionHistory.push({
                action: reason,
                exp: amount,
                time: new Date().toLocaleTimeString('ru-RU')
            });
            
            // Check for rank up
            if (oldRank.name !== newRank.name) {
                alert(`üéâ –ü–û–í–´–®–ï–ù–ò–ï –†–ê–ù–ì–ê!\n\n${oldRank.emoji} ${oldRank.name} ‚Üí ${newRank.emoji} ${newRank.name}\n\n–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã!`);
                checkAchievements();
            }
            
            addNotification(`+${amount} –æ–ø—ã—Ç–∞: ${reason}`);
        }
        
        function checkAchievements() {
            if (!appState.currentDarkUser) return;
            
            appState.achievements.forEach(ach => {
                if (!appState.currentDarkUser.achievements.includes(ach.id)) {
                    let earned = false;
                    
                    if (ach.id === 1 && appState.currentDarkUser.deals >= 1) earned = true;
                    if (ach.id === 2 && appState.currentDarkUser.items && appState.currentDarkUser.items.length >= 10) earned = true;
                    if (ach.id === 3 && appState.currentDarkUser.experience >= 1001) earned = true;
                    if (ach.id === 5 && appState.currentDarkUser.gang) earned = true;
                    
                    if (earned) {
                        appState.currentDarkUser.achievements.push(ach.id);
                        appState.currentDarkUser.experience += ach.reward;
                        alert(`üèÜ –î–û–°–¢–ò–ñ–ï–ù–ò–ï –†–ê–ó–ë–õ–û–ö–ò–†–û–í–ê–ù–û!\n\n${ach.icon} ${ach.name}\n${ach.desc}\n\n+${ach.reward} –æ–ø—ã—Ç–∞!`);
                    }
                }
            });
        }
        
        function addNotification(text) {
            appState.notifications.unshift({
                text: text,
                time: new Date().toLocaleTimeString('ru-RU'),
                read: false
            });
            if (appState.notifications.length > 50) {
                appState.notifications = appState.notifications.slice(0, 50);
            }
        }
        
        // Profile Functions
        function loadProfile() {
            if (!appState.currentDarkUser) return;
            
            const user = appState.currentDarkUser;
            const rank = getUserRank(user.experience);
            const nextRank = appState.ranks.find(r => r.min > user.experience) || rank;
            const progress = ((user.experience - rank.min) / (rank.max - rank.min)) * 100;
            
            const profileContent = document.getElementById('profileContent');
            profileContent.innerHTML = `
                <div style="text-align: center; margin-bottom: 2rem;">
                    <div style="font-size: 4rem;">${user.avatar}</div>
                    <h2 style="color: var(--dark-red); margin: 1rem 0;">${user.username}</h2>
                    <div style="font-size: 1.5rem; margin: 0.5rem 0;">${rank.emoji} ${rank.name}</div>
                    <div style="font-size: 0.9rem; color: var(--light-text); margin-top: 0.5rem;">
                        üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π: ${appState.notifications.filter(n => !n.read).length}
                    </div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üìä –û–ø—ã—Ç –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å</h4>
                    <div style="margin-bottom: 0.5rem;">–û–ø—ã—Ç: ${user.experience} / ${nextRank.min}</div>
                    <div style="background: var(--dark-surface); height: 20px; border-radius: 10px; overflow: hidden; margin: 0.5rem 0;">
                        <div style="background: var(--dark-red); height: 100%; width: ${progress}%; transition: width 0.3s;"></div>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--light-text);">–î–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–Ω–≥–∞: ${nextRank.min - user.experience} –æ–ø—ã—Ç–∞</div>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin: 1rem 0;">
                    <div style="background: var(--dark-bg); padding: 1rem; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--dark-red);">${user.balance}</div>
                        <div style="font-size: 0.9rem;">–ë–∞–ª–∞–Ω—Å (‚ÇΩ)</div>
                    </div>
                    <div style="background: var(--dark-bg); padding: 1rem; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--dark-red);">${user.deals}</div>
                        <div style="font-size: 0.9rem;">–°–¥–µ–ª–æ–∫</div>
                    </div>
                    <div style="background: var(--dark-bg); padding: 1rem; border-radius: 8px; text-align: center;">
                        <div style="font-size: 2rem; color: var(--dark-red);">${user.reputation}</div>
                        <div style="font-size: 0.9rem;">–†–µ–ø—É—Ç–∞—Ü–∏—è</div>
                    </div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                    <div style="margin: 0.5rem 0;">üìÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è: ${user.registered}</div>
                    <div style="margin: 0.5rem 0;">üè¥ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞: ${user.gang || '–ù–µ—Ç'}</div>
                    <div style="margin: 0.5rem 0;">üìù –ë–∏–æ–≥—Ä–∞—Ñ–∏—è: ${user.bio || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üéØ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–∞–Ω–≥–∞</h4>
                    <div style="margin: 0.5rem 0;">‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏–π: ${rank.canCreate ? '–î–∞' : '‚ùå –ù–µ—Ç (–Ω—É–∂–µ–Ω —Ä–∞–Ω–≥ –£—á–∞—Å—Ç–Ω–∏–∫)'}</div>
                    <div style="margin: 0.5rem 0;">‚úÖ –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è: ${rank.canInvite ? `–î–∞ (${rank.maxInvites} —à—Ç.)` : '‚ùå –ù–µ—Ç (–Ω—É–∂–µ–Ω —Ä–∞–Ω–≥ –û–ø—ã—Ç–Ω—ã–π)'}</div>
                    <div style="margin: 0.5rem 0;">‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ –∏–Ω–≤–∞–π—Ç–æ–≤: ${user.invitesUsed} / ${rank.maxInvites}</div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üèÜ –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è (${user.achievements.length}/${appState.achievements.length})</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 1rem;">
                        ${appState.achievements.map(ach => {
                            const earned = user.achievements.includes(ach.id);
                            return `<div style="background: var(--dark-surface); padding: 1rem; border-radius: 8px; text-align: center; opacity: ${earned ? 1 : 0.3};">
                                <div style="font-size: 2rem;">${ach.icon}</div>
                                <div style="font-size: 0.9rem; margin-top: 0.5rem;">${ach.name}</div>
                                ${earned ? '<div style="color: #10b981; font-size: 0.8rem;">‚úì –ü–æ–ª—É—á–µ–Ω–æ</div>' : ''}
                            </div>`;
                        }).join('')}
                    </div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üìã –ò—Å—Ç–æ—Ä–∏—è –¥–µ–π—Å—Ç–≤–∏–π</h4>
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${user.actionHistory.slice(-10).reverse().map(h => 
                            `<div style="margin: 0.5rem 0; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;">
                                <span style="color: var(--dark-red);">${h.time}</span> - ${h.action} (+${h.exp} –æ–ø—ã—Ç–∞)
                            </div>`
                        ).join('') || '<div style="color: var(--light-text);">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</div>'}
                    </div>
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</h4>
                    <div style="max-height: 200px; overflow-y: auto;">
                        ${appState.notifications.slice(0, 10).map(n => 
                            `<div style="margin: 0.5rem 0; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px; ${n.read ? 'opacity: 0.6;' : ''}">
                                <span style="color: var(--dark-red);">${n.time}</span> - ${n.text}
                            </div>`
                        ).join('') || '<div style="color: var(--light-text);">–ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π</div>'}
                    </div>
                    ${appState.notifications.length > 0 ? '<button class="btn-dark" onclick="markAllRead()" style="margin-top: 0.5rem;">‚úì –ü–†–û–ß–ò–¢–ê–¢–¨ –í–°–ï</button>' : ''}
                </div>
                
                <div style="background: var(--dark-bg); padding: 1.5rem; border-radius: 10px; margin: 1rem 0;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h4>
                    <div>–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—Ö–æ–¥: ${user.loginHistory && user.loginHistory.length > 0 ? user.loginHistory[user.loginHistory.length - 1].time : '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</div>
                    <div style="margin-top: 0.5rem;">IP: ${user.loginHistory && user.loginHistory.length > 0 ? user.loginHistory[user.loginHistory.length - 1].ip : 'N/A'}</div>
                    <div style="margin-top: 1rem;">
                        <button class="btn-dark" onclick="viewLoginHistory()">üìä –ò–°–¢–û–†–ò–Ø –í–•–û–î–û–í</button>
                    </div>
                </div>
                
                <div style="margin-top: 2rem;">
                    <button class="btn-dark" onclick="editProfile()">‚úèÔ∏è –†–ï–î–ê–ö–¢–ò–†–û–í–ê–¢–¨ –ü–†–û–§–ò–õ–¨</button>
                    ${rank.canInvite && user.invitesUsed < rank.maxInvites ? 
                        '<button class="btn-dark" onclick="generateUserInvite()" style="margin-left: 1rem;">üîó –°–û–ó–î–ê–¢–¨ –ò–ù–í–ê–ô–¢</button>' : ''}
                    <button class="btn-dark" onclick="viewNotifications()" style="margin-left: 1rem;">üîî –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø</button>
                    <button class="btn-dark" onclick="viewDailyQuests()" style="margin-left: 1rem;">üéØ –ó–ê–î–ê–ù–ò–Ø</button>
                </div>
            `;
        }
        
        function editProfile() {
            const user = appState.currentDarkUser;
            const newAvatar = prompt('–í–≤–µ–¥–∏—Ç–µ —ç–º–æ–¥–∑–∏ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∞:', user.avatar);
            if (newAvatar) user.avatar = newAvatar;
            
            const newBio = prompt('–í–≤–µ–¥–∏—Ç–µ –±–∏–æ–≥—Ä–∞—Ñ–∏—é:', user.bio);
            if (newBio !== null) user.bio = newBio;
            
            loadProfile();
            alert('–ü—Ä–æ—Ñ–∏–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω!');
        }
        
        function generateUserInvite() {
            const user = appState.currentDarkUser;
            const rank = getUserRank(user.experience);
            
            if (!rank.canInvite) {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤');
                return;
            }
            
            if (user.invitesUsed >= rank.maxInvites) {
                alert('‚ùå –î–æ—Å—Ç–∏–≥–Ω—É—Ç –ª–∏–º–∏—Ç –∏–Ω–≤–∞–π—Ç–æ–≤');
                return;
            }
            
            const inviteCode = 'https://invite.to/rp-market/' + Math.random().toString(36).substr(2, 9);
            appState.validInvites.push(inviteCode);
            user.invitesUsed++;
            
            alert(`‚úÖ –ò–ù–í–ê–ô–¢ –°–û–ó–î–ê–ù!\n\n${inviteCode}\n\n–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–æ: ${user.invitesUsed} / ${rank.maxInvites}`);
            loadProfile();
        }
        
        // Escrow System
        function loadEscrow() {
            if (!appState.escrows) appState.escrows = [];
            
            const escrowList = document.getElementById('escrowList');
            escrowList.innerHTML = '';
            
            const userEscrows = appState.escrows.filter(e => 
                e.seller === appState.currentDarkUser.username || 
                e.buyer === appState.currentDarkUser.username
            );
            
            if (userEscrows.length === 0) {
                escrowList.innerHTML = '<p style="color: var(--light-text); text-align: center;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</p>';
                return;
            }
            
            userEscrows.forEach(escrow => {
                const escrowCard = document.createElement('div');
                escrowCard.className = 'item-card';
                escrowCard.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem;">
                        <span class="item-name">–°–¥–µ–ª–∫–∞ #${escrow.id}</span>
                        <span style="padding: 0.25rem 0.75rem; background: ${escrow.status === 'pending' ? '#f59e0b' : escrow.status === 'confirmed' ? '#10b981' : '#ef4444'}; border-radius: 20px; font-size: 0.85rem;">
                            ${escrow.status === 'pending' ? '‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ' : escrow.status === 'confirmed' ? '‚úÖ –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ' : 'üîí –ó–∞–≤–µ—Ä—à–µ–Ω–æ'}
                        </span>
                    </div>
                    <div style="margin: 0.5rem 0;">üí∞ –°—É–º–º–∞: ${escrow.amount} ‚ÇΩ</div>
                    <div style="margin: 0.5rem 0;">üë§ –ü—Ä–æ–¥–∞–≤–µ—Ü: ${escrow.seller}</div>
                    <div style="margin: 0.5rem 0;">üë§ –ü–æ–∫—É–ø–∞—Ç–µ–ª—å: ${escrow.buyer}</div>
                    <div style="margin: 0.5rem 0;">üìù ${escrow.description}</div>
                    ${escrow.status === 'pending' && escrow.buyer === appState.currentDarkUser.username ? 
                        '<button class="btn-dark" onclick="confirmEscrow(' + escrow.id + ')">‚úÖ –ü–û–î–¢–í–ï–†–î–ò–¢–¨ –ü–û–õ–£–ß–ï–ù–ò–ï</button>' : ''}
                    ${escrow.status === 'confirmed' && escrow.seller === appState.currentDarkUser.username ? 
                        '<button class="btn-dark" onclick="completeEscrow(' + escrow.id + ')">üí∞ –ü–û–õ–£–ß–ò–¢–¨ –î–ï–ù–¨–ì–ò</button>' : ''}
                `;
                escrowList.appendChild(escrowCard);
            });
        }
        
        function createEscrow() {
            if (!appState.currentDarkUser) return;
            
            const buyer = document.getElementById('escrowBuyer').value;
            const amount = parseInt(document.getElementById('escrowAmount').value);
            const description = document.getElementById('escrowDescription').value;
            
            if (!buyer || !amount || !description) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (!appState.darkUsers[buyer]) {
                alert('–ü–æ–∫—É–ø–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω');
                return;
            }
            
            if (!appState.escrows) appState.escrows = [];
            
            const escrow = {
                id: appState.escrows.length + 1,
                seller: appState.currentDarkUser.username,
                buyer: buyer,
                amount: amount,
                description: description,
                status: 'pending',
                created: new Date().toLocaleString('ru-RU')
            };
            
            appState.escrows.push(escrow);
            
            // Clear form
            document.getElementById('escrowBuyer').value = '';
            document.getElementById('escrowAmount').value = '';
            document.getElementById('escrowDescription').value = '';
            
            alert('‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Å–¥–µ–ª–∫–∞ —Å–æ–∑–¥–∞–Ω–∞!');
            loadEscrow();
        }
        
        function confirmEscrow(id) {
            const escrow = appState.escrows.find(e => e.id === id);
            if (escrow) {
                escrow.status = 'confirmed';
                addNotification('–°–¥–µ–ª–∫–∞ #' + id + ' –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–º');
                alert('‚úÖ –í—ã –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª–∏ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞!');
                loadEscrow();
            }
        }
        
        function completeEscrow(id) {
            const escrow = appState.escrows.find(e => e.id === id);
            if (escrow) {
                escrow.status = 'completed';
                appState.currentDarkUser.balance += escrow.amount;
                appState.currentDarkUser.deals++;
                addExperience(10, '–£—Å–ø–µ—à–Ω–∞—è —Å–¥–µ–ª–∫–∞');
                document.getElementById('userBalance').textContent = appState.currentDarkUser.balance;
                alert('‚úÖ –°–¥–µ–ª–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –î–µ–Ω—å–≥–∏ –ø–æ–ª—É—á–µ–Ω—ã. +10 –æ–ø—ã—Ç–∞');
                loadEscrow();
            }
        }
        
        // Wallet System
        function loadWallet() {
            if (!appState.currentDarkUser) return;
            
            const user = appState.currentDarkUser;
            const walletContent = document.getElementById('walletContent');
            
            const rates = { btc: 4500000, eth: 250000, usdt: 90 };
            
            walletContent.innerHTML = `
                <div style="background: var(--dark-surface); padding: 1.5rem; border-radius: 10px;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">‚Çø Bitcoin</h4>
                    <div style="font-size: 2rem; color: var(--dark-red); margin: 1rem 0;">${user.wallets.btc.toFixed(8)} BTC</div>
                    <div style="font-size: 0.9rem; color: var(--light-text);">‚âà ${(user.wallets.btc * rates.btc).toFixed(2)} ‚ÇΩ</div>
                    <div style="margin-top: 1rem;">
                        <button class="btn-dark" onclick="depositCrypto('btc')">üì• –ü–û–ü–û–õ–ù–ò–¢–¨</button>
                        <button class="btn-dark" onclick="withdrawCrypto('btc')" style="margin-left: 0.5rem;">üì§ –í–´–í–ï–°–¢–ò</button>
                    </div>
                </div>
                
                <div style="background: var(--dark-surface); padding: 1.5rem; border-radius: 10px;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">Œû Ethereum</h4>
                    <div style="font-size: 2rem; color: var(--dark-red); margin: 1rem 0;">${user.wallets.eth.toFixed(6)} ETH</div>
                    <div style="font-size: 0.9rem; color: var(--light-text);">‚âà ${(user.wallets.eth * rates.eth).toFixed(2)} ‚ÇΩ</div>
                    <div style="margin-top: 1rem;">
                        <button class="btn-dark" onclick="depositCrypto('eth')">üì• –ü–û–ü–û–õ–ù–ò–¢–¨</button>
                        <button class="btn-dark" onclick="withdrawCrypto('eth')" style="margin-left: 0.5rem;">üì§ –í–´–í–ï–°–¢–ò</button>
                    </div>
                </div>
                
                <div style="background: var(--dark-surface); padding: 1.5rem; border-radius: 10px;">
                    <h4 style="color: var(--dark-red); margin-bottom: 1rem;">‚ÇÆ USDT</h4>
                    <div style="font-size: 2rem; color: var(--dark-red); margin: 1rem 0;">${user.wallets.usdt.toFixed(2)} USDT</div>
                    <div style="font-size: 0.9rem; color: var(--light-text);">‚âà ${(user.wallets.usdt * rates.usdt).toFixed(2)} ‚ÇΩ</div>
                    <div style="margin-top: 1rem;">
                        <button class="btn-dark" onclick="depositCrypto('usdt')">üì• –ü–û–ü–û–õ–ù–ò–¢–¨</button>
                        <button class="btn-dark" onclick="withdrawCrypto('usdt')" style="margin-left: 0.5rem;">üì§ –í–´–í–ï–°–¢–ò</button>
                    </div>
                </div>
            `;
            
            // Load transaction history
            if (!appState.transactions) appState.transactions = [];
            const history = document.getElementById('transactionHistory');
            const userTx = appState.transactions.filter(tx => tx.user === user.username).slice(-20).reverse();
            
            if (userTx.length === 0) {
                history.innerHTML = '<p style="color: var(--light-text);">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</p>';
            } else {
                history.innerHTML = userTx.map(tx => 
                    `<div style="margin: 0.5rem 0; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;">
                        <div style="display: flex; justify-content: space-between;">
                            <span>${tx.type === 'deposit' ? 'üì•' : 'üì§'} ${tx.currency.toUpperCase()}</span>
                            <span style="color: ${tx.type === 'deposit' ? '#10b981' : '#ef4444'};">${tx.type === 'deposit' ? '+' : '-'}${tx.amount}</span>
                        </div>
                        <div style="font-size: 0.85rem; color: var(--light-text);">${tx.time}</div>
                    </div>`
                ).join('');
            }
        }
        
        function depositCrypto(currency) {
            const address = 'bc1q' + Math.random().toString(36).substr(2, 30);
            alert(`üì• –ü–û–ü–û–õ–ù–ï–ù–ò–ï ${currency.toUpperCase()}\n\n–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–∞ –∞–¥—Ä–µ—Å:\n${address}\n\n‚ö†Ô∏è –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è. –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –Ω–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç.`);
            
            // Simulate deposit
            const amount = parseFloat(prompt('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏:'));
            if (amount && amount > 0) {
                appState.currentDarkUser.wallets[currency] += amount;
                if (!appState.transactions) appState.transactions = [];
                appState.transactions.push({
                    user: appState.currentDarkUser.username,
                    type: 'deposit',
                    currency: currency,
                    amount: amount,
                    time: new Date().toLocaleString('ru-RU')
                });
                addNotification(`–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ ${currency.toUpperCase()}: +${amount}`);
                loadWallet();
            }
        }
        
        function withdrawCrypto(currency) {
            const amount = parseFloat(prompt(`–°—É–º–º–∞ –≤—ã–≤–æ–¥–∞ (${currency.toUpperCase()}):`, '0'));
            if (!amount || amount <= 0) return;
            
            if (appState.currentDarkUser.wallets[currency] < amount) {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                return;
            }
            
            const address = prompt('–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞:');
            if (!address) return;
            
            appState.currentDarkUser.wallets[currency] -= amount;
            if (!appState.transactions) appState.transactions = [];
            appState.transactions.push({
                user: appState.currentDarkUser.username,
                type: 'withdraw',
                currency: currency,
                amount: amount,
                time: new Date().toLocaleString('ru-RU')
            });
            addNotification(`–í—ã–≤–æ–¥ ${currency.toUpperCase()}: -${amount}`);
            alert('‚úÖ –ó–∞—è–≤–∫–∞ –Ω–∞ –≤—ã–≤–æ–¥ —Å–æ–∑–¥–∞–Ω–∞!\n\n‚ö†Ô∏è –≠—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è');
            loadWallet();
        }
        
        // Auctions System
        function loadAuctions() {
            if (!appState.auctions) appState.auctions = [];
            
            const auctionsList = document.getElementById('auctionsList');
            auctionsList.innerHTML = '';
            
            if (appState.auctions.length === 0) {
                auctionsList.innerHTML = '<p style="color: var(--light-text); text-align: center;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞—É–∫—Ü–∏–æ–Ω–æ–≤</p>';
                return;
            }
            
            appState.auctions.forEach(auction => {
                const timeLeft = Math.max(0, Math.floor((auction.endTime - Date.now()) / 1000));
                const isActive = timeLeft > 0;
                
                const auctionCard = document.createElement('div');
                auctionCard.className = 'item-card';
                auctionCard.innerHTML = `
                    <div class="item-name">${auction.name}</div>
                    <div style="margin: 1rem 0;">
                        <div>–¢–µ–∫—É—â–∞—è —Å—Ç–∞–≤–∫–∞: <span style="color: var(--dark-red); font-size: 1.3rem;">${auction.currentBid} ‚ÇΩ</span></div>
                        <div style="font-size: 0.9rem; color: var(--light-text);">–°—Ç–∞–≤–æ–∫: ${auction.bids.length}</div>
                        <div style="font-size: 0.9rem; color: var(--light-text);">–õ–∏–¥–µ—Ä: ${auction.leader || '–ù–µ—Ç —Å—Ç–∞–≤–æ–∫'}</div>
                    </div>
                    <div style="margin: 1rem 0; padding: 0.75rem; background: ${isActive ? 'var(--dark-bg)' : '#ef4444'}; border-radius: 5px; text-align: center;">
                        ${isActive ? `‚è∞ –û—Å—Ç–∞–ª–æ—Å—å: ${Math.floor(timeLeft / 60)}–º ${timeLeft % 60}—Å` : 'üî¥ –ó–ê–í–ï–†–®–Å–ù'}
                    </div>
                    ${isActive && auction.seller !== appState.currentDarkUser.username ? 
                        `<input type="number" id="bid${auction.id}" placeholder="–í–∞—à–∞ —Å—Ç–∞–≤–∫–∞" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; background: var(--dark-bg); color: white; border: 1px solid var(--dark-border); border-radius: 5px;">
                        <button class="btn-dark" onclick="makeBid(${auction.id})">üí∞ –°–î–ï–õ–ê–¢–¨ –°–¢–ê–í–ö–£</button>` : ''}
                `;
                auctionsList.appendChild(auctionCard);
            });
            
            // Update timers
            setTimeout(() => {
                if (document.getElementById('auctionsTab').classList.contains('hidden') === false) {
                    loadAuctions();
                }
            }, 1000);
        }
        
        function createAuction() {
            if (!appState.currentDarkUser) return;
            
            const rank = getUserRank(appState.currentDarkUser.experience);
            if (!rank.canCreate) {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø—Ä–∞–≤ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞—É–∫—Ü–∏–æ–Ω–∞');
                return;
            }
            
            const name = document.getElementById('auctionName').value;
            const startBid = parseInt(document.getElementById('auctionStart').value);
            const duration = parseInt(document.getElementById('auctionDuration').value);
            
            if (!name || !startBid || !duration) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (!appState.auctions) appState.auctions = [];
            
            const auction = {
                id: appState.auctions.length + 1,
                name: name,
                seller: appState.currentDarkUser.username,
                startBid: startBid,
                currentBid: startBid,
                bids: [],
                leader: null,
                endTime: Date.now() + (duration * 60 * 1000),
                created: new Date().toLocaleString('ru-RU')
            };
            
            appState.auctions.push(auction);
            
            document.getElementById('auctionName').value = '';
            document.getElementById('auctionStart').value = '';
            document.getElementById('auctionDuration').value = '';
            
            alert('‚úÖ –ê—É–∫—Ü–∏–æ–Ω —Å–æ–∑–¥–∞–Ω!');
            loadAuctions();
        }
        
        function makeBid(auctionId) {
            const auction = appState.auctions.find(a => a.id === auctionId);
            if (!auction) return;
            
            const bidAmount = parseInt(document.getElementById('bid' + auctionId).value);
            
            if (!bidAmount || bidAmount <= auction.currentBid) {
                alert('‚ùå –°—Ç–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –≤—ã—à–µ —Ç–µ–∫—É—â–µ–π');
                return;
            }
            
            if (appState.currentDarkUser.balance < bidAmount) {
                alert('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
                return;
            }
            
            auction.currentBid = bidAmount;
            auction.leader = appState.currentDarkUser.username;
            auction.bids.push({
                user: appState.currentDarkUser.username,
                amount: bidAmount,
                time: new Date().toLocaleTimeString('ru-RU')
            });
            
            alert('‚úÖ –°—Ç–∞–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞!');
            loadAuctions();
        }
        
        // Forum System
        function loadForum() {
            if (!appState.forumTopics) appState.forumTopics = [];
            
            const forumTopics = document.getElementById('forumTopics');
            forumTopics.innerHTML = '';
            
            if (appState.forumTopics.length === 0) {
                forumTopics.innerHTML = '<p style="color: var(--light-text); text-align: center;">–ù–µ—Ç —Ç–µ–º –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è</p>';
                return;
            }
            
            appState.forumTopics.forEach(topic => {
                const topicCard = document.createElement('div');
                topicCard.className = 'item-card';
                topicCard.innerHTML = `
                    <div class="item-name">${topic.title}</div>
                    <div style="margin: 1rem 0; font-size: 0.9rem;">${topic.content.substring(0, 200)}${topic.content.length > 200 ? '...' : ''}</div>
                    <div style="display: flex; justify-content: space-between; font-size: 0.85rem; color: var(--light-text);">
                        <span>üë§ ${topic.author}</span>
                        <span>üí¨ –û—Ç–≤–µ—Ç–æ–≤: ${topic.replies ? topic.replies.length : 0}</span>
                        <span>‚è∞ ${topic.time}</span>
                    </div>
                    <button class="btn-dark" onclick="viewTopic(${topic.id})" style="margin-top: 1rem;">üìñ –û–¢–ö–†–´–¢–¨</button>
                `;
                forumTopics.appendChild(topicCard);
            });
        }
        
        function createTopic() {
            if (!appState.currentDarkUser) return;
            
            const title = document.getElementById('topicTitle').value;
            const content = document.getElementById('topicContent').value;
            
            if (!title || !content) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è');
                return;
            }
            
            if (!appState.forumTopics) appState.forumTopics = [];
            
            const topic = {
                id: appState.forumTopics.length + 1,
                title: title,
                content: content,
                author: appState.currentDarkUser.username,
                time: new Date().toLocaleString('ru-RU'),
                replies: []
            };
            
            appState.forumTopics.push(topic);
            
            document.getElementById('topicTitle').value = '';
            document.getElementById('topicContent').value = '';
            
            alert('‚úÖ –¢–µ–º–∞ —Å–æ–∑–¥–∞–Ω–∞!');
            loadForum();
        }
        
        function viewTopic(topicId) {
            const topic = appState.forumTopics.find(t => t.id === topicId);
            if (!topic) return;
            
            let repliesHtml = topic.replies.map(r => 
                `<div style="background: var(--dark-surface); padding: 1rem; margin: 0.5rem 0; border-radius: 5px; border-left: 3px solid var(--dark-red);">
                    <div style="color: var(--dark-red); font-weight: bold;">${r.author}</div>
                    <div style="margin: 0.5rem 0;">${r.content}</div>
                    <div style="font-size: 0.8rem; color: var(--light-text);">${r.time}</div>
                </div>`
            ).join('');
            
            alert(`${topic.title}\n\n–ê–≤—Ç–æ—Ä: ${topic.author}\n–í—Ä–µ–º—è: ${topic.time}\n\n${topic.content}\n\n–û—Ç–≤–µ—Ç–æ–≤: ${topic.replies.length}\n\n(–§—É–Ω–∫—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞)`);
        }
        
        // Admin Panel Enhanced Functions
        function searchUsers() {
            const search = document.getElementById('adminUserSearch').value.toLowerCase();
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            Object.values(appState.darkUsers).filter(u => 
                u.username.toLowerCase().includes(search)
            ).forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;';
                const rank = getUserRank(user.experience);
                userDiv.innerHTML = `
                    <div>
                        <div>${rank.emoji} ${user.username} (${user.balance}‚ÇΩ)</div>
                        <div style="font-size: 0.8rem; color: var(--light-text);">–û–ø—ã—Ç: ${user.experience} | –°–¥–µ–ª–æ–∫: ${user.deals}</div>
                    </div>
                    <div>
                        <button class="btn-dark" onclick="editUserAdmin('${user.username}')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">‚úèÔ∏è</button>
                        <button class="delete-btn" onclick="deleteUser('${user.username}')" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-left: 0.5rem;">X</button>
                    </div>
                `;
                usersList.appendChild(userDiv);
            });
        }
        
        function editUserAdmin(username) {
            const user = appState.darkUsers[username];
            if (!user) return;
            
            const newBalance = prompt('–ù–æ–≤—ã–π –±–∞–ª–∞–Ω—Å:', user.balance);
            if (newBalance !== null) user.balance = parseInt(newBalance);
            
            const newExp = prompt('–ù–æ–≤—ã–π –æ–ø—ã—Ç:', user.experience);
            if (newExp !== null) user.experience = parseInt(newExp);
            
            alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±–Ω–æ–≤–ª—ë–Ω!');
            loadAdminPanel();
        }
        
        function generateInvite() {
            const code = 'https://invite.to/rp-market/admin_' + Math.random().toString(36).substr(2, 9);
            appState.validInvites.push(code);
            alert(`‚úÖ –ò–ù–í–ê–ô–¢ –°–û–ó–î–ê–ù (–∞–¥–º–∏–Ω):\n\n${code}`);
        }
        
        function saveSettings() {
            alert('‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!\n\n(–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å –±—ã)');
        }
        
        function exportLogs() {
            let logs = '–õ–û–ì–ò –ü–õ–û–©–ê–î–ö–ò\n\n';
            logs += '–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ' + Object.keys(appState.darkUsers).length + '\n';
            logs += '–¢–æ–≤–∞—Ä–æ–≤: ' + appState.darkItems.length + '\n';
            logs += '–°–æ–æ–±—â–µ–Ω–∏–π: ' + appState.chatMessages.length + '\n\n';
            logs += '--- –ò–°–¢–û–†–ò–Ø –í–•–û–î–û–í ---\n';
            Object.values(appState.darkUsers).forEach(u => {
                if (u.loginHistory && u.loginHistory.length > 0) {
                    logs += u.username + ': ' + u.loginHistory.length + ' –≤—Ö–æ–¥–æ–≤\n';
                }
            });
            
            alert('üì• –≠–ö–°–ü–û–†–¢ –õ–û–ì–û–í\n\n' + logs);
        }
        
        function deleteItem(itemId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                appState.darkItems = appState.darkItems.filter(item => item.id !== itemId);
                loadMyItems();
                loadDarkItems();
                alert('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω!');
            }
        }
        
        function editItem(itemId) {
            alert('–§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏');
        }

        // Dark Web Effects
        function startDarkWebEffects() {
            if (appState.isDarkMode) {
                // Random freeze effects
                setInterval(() => {
                    if (appState.isDarkMode && Math.random() < 0.15) {
                        addFreezeEffect();
                    }
                }, 3000);
            }
        }

        function addFreezeEffect() {
            document.body.classList.add('freeze');
            setTimeout(() => {
                document.body.classList.remove('freeze');
            }, 1500);
        }

        function addGlitchEffect() {
            document.getElementById('darkMarket').classList.add('glitch');
            setTimeout(() => {
                document.getElementById('darkMarket').classList.remove('glitch');
            }, 300);
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    modal.style.display = 'none';
                }
            });
        }

        // Admin Panel functions
        function loadAdminPanel() {
            if (!appState.currentDarkUser || appState.currentDarkUser.role !== 'darkweb_admin') {
                alert('–ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞!');
                return;
            }
            
            updateAdminStats();
            loadAdminUsers();
            loadAdminItems();
            loadAdminGangs();
            loadAdminEscrow();
            loadAdminLogs();
            loadAdminAnalytics();
        }
        
        function loadAdminEscrow() {
            if (!appState.escrows) return;
            
            const escrowList = document.getElementById('adminEscrowList');
            escrowList.innerHTML = '';
            
            appState.escrows.filter(e => e.status !== 'completed').forEach(escrow => {
                const escrowDiv = document.createElement('div');
                escrowDiv.style.cssText = 'margin-bottom: 0.5rem; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;';
                escrowDiv.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div>
                            <div>–°–¥–µ–ª–∫–∞ #${escrow.id}: ${escrow.amount}‚ÇΩ</div>
                            <div style="font-size: 0.8rem; color: var(--light-text);">${escrow.seller} ‚Üí ${escrow.buyer}</div>
                        </div>
                        <button class="btn-dark" onclick="resolveDispute(${escrow.id})" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">‚úì –†–ï–®–ò–¢–¨</button>
                    </div>
                `;
                escrowList.appendChild(escrowDiv);
            });
            
            if (escrowList.children.length === 0) {
                escrowList.innerHTML = '<p style="color: var(--light-text); font-size: 0.85rem;">–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Ä–æ–≤</p>';
            }
        }
        
        function resolveDispute(escrowId) {
            const action = confirm('–í–µ—Ä–Ω—É—Ç—å –¥–µ–Ω—å–≥–∏ –ø–æ–∫—É–ø–∞—Ç–µ–ª—é? (OK = –¥–∞, –û—Ç–º–µ–Ω–∞ = –ø—Ä–æ–¥–∞–≤—Ü—É)');
            const escrow = appState.escrows.find(e => e.id === escrowId);
            if (!escrow) return;
            
            if (action) {
                // Refund buyer
                if (appState.darkUsers[escrow.buyer]) {
                    appState.darkUsers[escrow.buyer].balance += escrow.amount;
                }
                alert('‚úÖ –°—Ä–µ–¥—Å—Ç–≤–∞ –≤–æ–∑–≤—Ä–∞—â–µ–Ω—ã –ø–æ–∫—É–ø–∞—Ç–µ–ª—é');
            } else {
                // Pay seller
                if (appState.darkUsers[escrow.seller]) {
                    appState.darkUsers[escrow.seller].balance += escrow.amount;
                }
                alert('‚úÖ –°—Ä–µ–¥—Å—Ç–≤–∞ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω—ã –ø—Ä–æ–¥–∞–≤—Ü—É');
            }
            
            escrow.status = 'completed';
            loadAdminPanel();
        }
        
        function loadAdminLogs() {
            const logsList = document.getElementById('adminLogs');
            logsList.innerHTML = '';
            
            const allLogs = [];
            Object.values(appState.darkUsers).forEach(user => {
                if (user.loginHistory && user.loginHistory.length > 0) {
                    user.loginHistory.slice(-5).forEach(log => {
                        allLogs.push({
                            user: user.username,
                            time: log.time,
                            ip: log.ip,
                            device: log.device
                        });
                    });
                }
            });
            
            allLogs.sort((a, b) => new Date(b.time) - new Date(a.time));
            
            allLogs.slice(0, 20).forEach(log => {
                const logDiv = document.createElement('div');
                logDiv.style.cssText = 'margin-bottom: 0.25rem; padding: 0.25rem; background: var(--dark-surface); border-radius: 3px;';
                logDiv.innerHTML = `<span style="color: var(--dark-red);">${log.user}</span> | ${log.time} | ${log.ip}`;
                logsList.appendChild(logDiv);
            });
            
            if (allLogs.length === 0) {
                logsList.innerHTML = '<p style="color: var(--light-text);">–ù–µ—Ç –ª–æ–≥–æ–≤</p>';
            }
        }
        
        function loadAdminAnalytics() {
            const analytics = document.getElementById('adminAnalytics');
            
            // Calculate stats
            const totalBalance = Object.values(appState.darkUsers).reduce((sum, u) => sum + (u.balance || 0), 0);
            const avgBalance = totalBalance / Object.keys(appState.darkUsers).length;
            const totalExp = Object.values(appState.darkUsers).reduce((sum, u) => sum + (u.experience || 0), 0);
            const totalDeals = Object.values(appState.darkUsers).reduce((sum, u) => sum + (u.deals || 0), 0);
            
            // Rank distribution
            const rankDist = {};
            appState.ranks.forEach(r => rankDist[r.name] = 0);
            Object.values(appState.darkUsers).forEach(u => {
                const rank = getUserRank(u.experience || 0);
                rankDist[rank.name]++;
            });
            
            analytics.innerHTML = `
                <div style="margin-bottom: 0.5rem;">üí∞ –°—Ä–µ–¥–Ω–∏–π –±–∞–ª–∞–Ω—Å: ${Math.floor(avgBalance)}‚ÇΩ</div>
                <div style="margin-bottom: 0.5rem;">üìä –í—Å–µ–≥–æ –æ–ø—ã—Ç–∞: ${totalExp}</div>
                <div style="margin-bottom: 0.5rem;">ü§ù –í—Å–µ–≥–æ —Å–¥–µ–ª–æ–∫: ${totalDeals}</div>
                <div style="margin-top: 1rem; font-size: 0.9rem; color: var(--light-text);">
                    <div style="font-weight: bold; margin-bottom: 0.5rem;">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–∞–Ω–≥–∞–º:</div>
                    ${Object.entries(rankDist).map(([name, count]) => 
                        `<div style="margin: 0.25rem 0;">${name}: ${count} —á–µ–ª.</div>`
                    ).join('')}
                </div>
            `;
            
            // Update totals
            document.getElementById('totalBalance').textContent = totalBalance;
            document.getElementById('totalTransactions').textContent = (appState.transactions || []).length;
        }
        
        function updateAdminStats() {
            document.getElementById('totalUsers').textContent = Object.keys(appState.darkUsers).length;
            document.getElementById('totalItems').textContent = appState.darkItems.length;
            document.getElementById('totalGangs').textContent = appState.gangs.length;
            document.getElementById('totalMessages').textContent = appState.chatMessages.length;
        }
        
        function loadAdminUsers() {
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';
            
            Object.values(appState.darkUsers).forEach(user => {
                const userDiv = document.createElement('div');
                userDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;';
                userDiv.innerHTML = `
                    <span>${user.username} (–±–∞–ª–∞–Ω—Å: ${user.balance}‚ÇΩ)</span>
                    <button class="delete-btn" onclick="deleteUser('${user.username}')">X</button>
                `;
                usersList.appendChild(userDiv);
            });
        }
        
        function loadAdminItems() {
            const itemsList = document.getElementById('adminItemsList');
            itemsList.innerHTML = '';
            
            appState.darkItems.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;';
                itemDiv.innerHTML = `
                    <span>${item.name} (${item.seller})</span>
                    <button class="delete-btn" onclick="adminDeleteItem(${item.id})">X</button>
                `;
                itemsList.appendChild(itemDiv);
            });
        }
        
        function loadAdminGangs() {
            const gangsList = document.getElementById('adminGangsList');
            gangsList.innerHTML = '';
            
            appState.gangs.forEach(gang => {
                const gangDiv = document.createElement('div');
                gangDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem; padding: 0.5rem; background: var(--dark-surface); border-radius: 5px;';
                gangDiv.innerHTML = `
                    <span>${gang.name} (—É—á–∞—Å—Ç–Ω–∏–∫–æ–≤: ${gang.members})</span>
                    <button class="delete-btn" onclick="deleteGang(${gang.id})">X</button>
                `;
                gangsList.appendChild(gangDiv);
            });
        }
        
        function deleteUser(username) {
            if (confirm(`–£–¥–∞–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${username}?`)) {
                delete appState.darkUsers[username];
                loadAdminUsers();
                updateAdminStats();
                alert('–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–¥–∞–ª—ë–Ω!');
            }
        }
        
        function adminDeleteItem(itemId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç —Ç–æ–≤–∞—Ä?')) {
                appState.darkItems = appState.darkItems.filter(item => item.id !== itemId);
                loadAdminItems();
                loadDarkItems();
                updateAdminStats();
                alert('–¢–æ–≤–∞—Ä —É–¥–∞–ª—ë–Ω!');
            }
        }
        
        function deleteGang(gangId) {
            if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É?')) {
                appState.gangs = appState.gangs.filter(gang => gang.id !== gangId);
                loadAdminGangs();
                loadGangs();
                updateAdminStats();
                alert('–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É–¥–∞–ª–µ–Ω–∞!');
            }
        }
        
        function clearAllData() {
            if (confirm('–£–¥–∞–ª–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å!')) {
                appState.darkUsers = {};
                appState.darkItems = [];
                appState.gangs = [];
                appState.chatMessages = [];
                loadAdminPanel();
                alert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!');
            }
        }
        
        function resetSystem() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å —Å–∏—Å—Ç–µ–º—É –¥–æ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è?')) {
                location.reload();
            }
        }

        // Auto-save reminder
        setInterval(() => {
            if (appState.isDarkMode && Math.random() < 0.1) {
                addNotification('‚ö° –°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ');
            }
        }, 60000);
        
        // Daily Quests System
        function checkDailyQuests() {
            if (!appState.currentDarkUser) return;
            
            if (!appState.currentDarkUser.quests) {
                appState.currentDarkUser.quests = {
                    daily: [
                        { id: 1, name: '–°–æ–≤–µ—Ä—à–∏—Ç–µ 1 —Å–¥–µ–ª–∫—É', progress: 0, target: 1, reward: 15, completed: false },
                        { id: 2, name: '–û—Ç–ø—Ä–∞–≤—å—Ç–µ 5 —Å–æ–æ–±—â–µ–Ω–∏–π', progress: 0, target: 5, reward: 10, completed: false },
                        { id: 3, name: '–ü–æ—Å–µ—Ç–∏—Ç–µ –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏', progress: 0, target: 1, reward: 5, completed: false }
                    ],
                    lastReset: new Date().toDateString()
                };
            }
            
            // Reset daily quests if it's a new day
            const today = new Date().toDateString();
            if (appState.currentDarkUser.quests.lastReset !== today) {
                appState.currentDarkUser.quests.daily.forEach(q => {
                    q.progress = 0;
                    q.completed = false;
                });
                appState.currentDarkUser.quests.lastReset = today;
            }
        }
        
        function viewDailyQuests() {
            checkDailyQuests();
            if (!appState.currentDarkUser) return;
            
            let questText = 'üéØ –ï–ñ–ï–î–ù–ï–í–ù–´–ï –ó–ê–î–ê–ù–ò–Ø\n\n';
            
            appState.currentDarkUser.quests.daily.forEach(q => {
                questText += `${q.completed ? '‚úÖ' : 'üî¥'} ${q.name}\n`;
                questText += `   –ü—Ä–æ–≥—Ä–µ—Å—Å: ${q.progress}/${q.target}\n`;
                questText += `   –ù–∞–≥—Ä–∞–¥–∞: +${q.reward} –æ–ø—ã—Ç–∞\n\n`;
            });
            
            alert(questText);
        }
        
        // Check for idle
        let lastActivity = Date.now();
        let idleCheckInterval;
        
        document.addEventListener('mousemove', () => lastActivity = Date.now());
        document.addEventListener('keypress', () => lastActivity = Date.now());
        
        function checkIdle() {
            if (appState.isDarkMode && Date.now() - lastActivity > 1800000) { // 30 min
                alert('‚ö†Ô∏è –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –í–´–•–û–î\n\n–°–µ–∞–Ω—Å –∑–∞–≤–µ—Ä—à—ë–Ω –∏–∑-–∑–∞ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (30 –º–∏–Ω)');
                exitDarkMarket();
            }
        }
        
        setInterval(checkIdle, 60000); // Check every minute
        
        // Show daily quests notification on login
        function showWelcomeMessage() {
            if (appState.currentDarkUser) {
                checkDailyQuests();
                const rank = getUserRank(appState.currentDarkUser.experience);
                setTimeout(() => {
                    const incomplete = appState.currentDarkUser.quests.daily.filter(q => !q.completed).length;
                    if (incomplete > 0) {
                        addNotification(`üéØ –£ –≤–∞—Å ${incomplete} –Ω–µ–∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π`);
                    }
                }, 2000);
            }
        }
    </script>
</body>
</html>
